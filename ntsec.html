<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="GENERATOR" CONTENT="Emacs [GNU]">
   <TITLE>NT Security - Frequently Asked Questions</TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE" VLINK="#551A8B" ALINK="#FF0000">

<H1>
NT Security - Frequently Asked Questions version 0.41</H1>

<ul>
   <LI> <A HREF="ntsec.html#thefaq">0.0 Information about this FAQ</A>

<UL>
   <LI> <A HREF="ntsec.html#legal">0.1 Legal stuff</A>
   <LI> <A HREF="ntsec.html#conv">0.2 Conventions used in this document </A>
   <LI> <A HREF="ntsec.html#update">0.3 Current version and updating information</A>
   <LI> <A HREF="ntsec.html#ntsec-changes">0.4 Changes</A>
   <LI> <A HREF="ntsec.html#credits">0.5 Credits</A>
</UL>

<LI> <A HREF="ntsec.html#defs">1.0 Definitions and general security issues</A>
<UL>
   <LI> <A HREF="ntsec.html#obook">1.1 Orange book, red book and C2</A>
   <LI> <A HREF="ntsec.html#crypto">1.2 Crypto</A>
   <LI> <A HREF="ntsec.html#gensec">1.3 Where do I get generic security information?</A>
</UL> <!-- 1.0 -->

<LI> <A HREF="ntsec.html#ntsec">2.0 Questions and answers on NT security</A>
<ul>
   <ul>
      <li> <a href="ntsec.html#qna-mscontact">2.0.1 How do I contact Microsoft on security issues?</a>
   </ul>
</ul>

<UL>
   <LI> <A HREF="ntsec.html#security-model">2.1 Security model</A>

   <UL>
      <LI> <A HREF="ntsec.html#nt-servpack">2.1.1 Where do I get patches, or, what is a Service Pack?</A>
      <LI> <A HREF="ntsec.html#ntsec-nt-impersonation">2.1.2 What is impersonation?</A>
      <LI> <A HREF="ntsec.html#ntsec-nt-sid">2.1.3 What is a SID (Security ID)?</A>
      <LI> <A HREF="ntsec.html#ntsec-privileges">2.1.4 What are privileges (user rights)?</A>
      <LI> <A HREF="ntsec.html#ntsec-ACEs">2.1.5 What is an ACE (Access Control Entry)?</A>
      <LI> <A HREF="ntsec.html#ntsec-ACLs">2.1.6 What is an ACL (Access Control List)?</A>
      <LI> <A HREF="ntsec.html#ntsec-SRM">2.1.7 What is SRM (Security Reference Monitor)?</A>
      <LI> <A HREF="ntsec.html#ntsec-LSA">2.1.8 What is LSA (Local Security Authority)?</A>
      <LI> <A HREF="ntsec.html#ntsec-SAM">2.1.9 What is SAM (Security Account Manager)?</A>
      <LI> <A HREF="ntsec.html#ntsec-secchan">2.1.10 What is a secure channel?</A>
      <LI> <A HREF="ntsec.html#ntsec-logon">2.1.11 How does the logon process work?</A>
      <LI> <A HREF="ntsec.html#ntsec-access-token">2.1.12 What is an access token?</A>
      <li> <A href="ntsec.html#secmod-pw">2.1.13 What about passwords?</A>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-host">2.2 Host security</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-host-virus">2.2.1 Are there any NT based viruses, or can NT be susceptible for other viruses?</A>
      <LI> <A HREF="ntsec.html#ntsec-host-c2">2.2.2 How do I get my computer C2-level secure, or, what is c2config?</A>
      <LI> <A HREF="ntsec.html#ntsec-ssave">2.2.3 Are there any known problems with the screen saver / screen lock program?</A>
      <LI> <A HREF="ntsec.html#ntsec-secclient">2.2.4 How can I secure my client computers against my users?</A>
      <LI> <A HREF="ntsec.html#host-pagefile">2.2.5 Can my pagefile hold sensitive data? </a>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-fs">2.3 File System</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-fs-reset">2.3.1 I Just installed a service pack. Why is my file permissions changed?</A>
      <LI> <A HREF="ntsec.html#ntsec-fs-bug1">2.3.2 Why can users without permissions delete files?</A>
      <LI> <A HREF="ntsec.html#ntsec-fs-ntfsread">2.3.3 Is it possible to read data on a NTFS disk from another OS?</A>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-reg">2.4 Registry</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-reg-hk-drop">2.4.1 Why does the HKEY_LOCAL_MACHINE key drop its settings?</A>
      <LI> <A HREF="ntsec.html#reg-remote">2.4.2 Is the registry accessible over the network? </A>
      <LI> <A HREF="ntsec.html#reg-interesting">2.4.3 Are there any especially interesting keys to watch? </A>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-usr">2.5 User security</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-usr-adm">2.5.1 Administrator account</A>
      <LI> <A HREF="ntsec.html#ntsec-usr-gst">2.5.2 Guest account</A>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-net">2.6 Network security</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-synflood">2.6.1 Is NT susceptible to SYN flood attacks?</A>
      <LI> <A HREF="ntsec.html#ntsec-pf">2.6.2 Is it possible to use packet filters on an NT machine?</A>
      <LI> <A HREF="ntsec.html#ntsec-net-nbt">2.6.3 What ports must I enable to let NBT (NetBios over TCP/IP) through my firewall?</A>
      <LI> <A HREF="ntsec.html#ntsec-net-auth">2.6.4 What is Authenticode?</A>
      <LI> <A HREF="ntsec.html#ntsec-net-snmp">2.6.5 What should I think about when using SNMP?</A>
      <LI> <A HREF="ntsec.html#ntsec-net-sna">2.6.6 Is there any known problems with SNA?</A>
      <LI> <A HREF="ntsec.html#ntsec-net-sna">2.6.7 What servers have TCP ports opened on my NT system? Or: Is netstat broken?</A>
      <LI> <A HREF="ntsec.html#ntsec-net-ping">2.6.8 What are giant packets? Or, is Windows NT susceptible to the PING attack?</A>
      <LI> <A HREF="ntsec.html#ntsec-dos-rpc">2.6.9 What about the denial-of-service problem with RPC?</A>
      <li> <a href="ntsec.html#net-chargen">2.6.11 Chargen flooding?</a>
      <li> <a href="ntsec.html#net-winsdos">2.6.12 WINS denial of service?</a>
      <li> <a href="ntsec.html#net-dhcp">2.6.13 Dynamic Host Configuration Protocol, DHCP</a>
      <li> <a href="ntsec.html#net-enumerate">2.6.14 How do I enumerate all listening named pipes? </a>
      <li> <a href="ntsec.html#net-oob">2.6.15 What is the OOB (Out of Band) attack? </a>
      <li> <a href="ntsec.html#net-fragbug">2.6.16 How does NT deal with fragmented IP packets? </a>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-fshare">2.7 File sharing security</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-fs-cifs">2.7.1 What is CIFS?</A>
      <LI> <A HREF="ntsec.html#ntsec-fshare-def">2.7.2 Is it possible to turn off the default sharing?</A>
      <LI> <A HREF="ntsec.html#ntsec-fshare-bug">2.7.3 Are there any known bugs for File sharing?</A>
      <LI> <A HREF="ntsec.html#fshare-nullsess">2.7.4 What is a NULL session? </A>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-apps">2.8 Application and subsystem security</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-apps-www">2.8.1 Web server security</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-fp">2.8.2 Frontpage</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-ftp">2.8.3 FTP server security</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-ie">2.8.4 Internet Explorer</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-roll">2.8.5 Rollback</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-shutdown">2.8.6 Shutdown.exe</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-exchange">2.8.7 Exchange</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-sna">2.8.8 Microsoft SNA </A>
      <LI> <A HREF="ntsec.html#ntsec-apps-ccmail"> 2.8.9 cc:Mail </A>
      <LI> <A HREF="ntsec.html#ntsec-apps-spoolss"> 2.8.10 NT Spooler Service </A>
      <li> <a href="ntsec.html#apps-odbc">2.8.11 ODBC Security </a>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-ras">2.9 RAS security</A>

   <LI> <A HREF="ntsec.html#ntsec-log">2.10 Logging</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsyslog">2.10.1 Is there a syslog function in NT?</A>
      <LI> <A HREF="ntsec.html#ntsec-log-move">2.10.2 Can I move the logs to another partition?</A>
      <LI> <A HREF="ntsec.html#ntsec-log-change">2.10.3 Can I grant access to someone to view or change the log files?</A>
      <li> <a href="ntsec.html#log-not-audited"> 2.10.5 Why doesn't all user right enabling actions show up in the log? </a>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-crypto">2.11 Crypto</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntsec-crypto-capi">2.11.1 What is CryptoAPI?</A>
      <li> <a href="ntsec.html#crypto-strongavail"> 2.11.2 Is strong cryptography available outside the U.S.? </a>
   </UL>

   <LI> <A HREF="ntsec.html#ntsec-email">2.12 E-mail security</A>

   <li> <a href="ntsec.html#secpatch"> 2.13 Security related patches </a>
   <ul>
      <li> <a href="ntsec.html#secpatch-4sp3">2.13.1 Security enhancements in SP3 for NT 4 </a>
   </ul>

   <li> <a href="ntsec.html#pw"> 2.14 Passwords </a>
   <ul>
      <li> <a href="ntsec.html#pw-service">2.14.1 Where is the password that I configure a service to start with stored? </a>
      <li> <a href="ntsec.html#pw-notif">2.14.2 How do I enforce strong passwords? </a>
   </ul>


</UL> <!-- 3.0 -->

<LI> <A HREF="ntsec.html#tools">3.0 NT based security products</A>
<UL>
   <LI> <A HREF="ntsec.html#ntcheck">3.1 What tools for checking NT security is there?</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntcheck-ksa">3.1.1 Kane Security Analyst</A>
      <LI> <A HREF="ntsec.html#ntcheck-omni">3.1.2 OmniGuard</A>
      <LI> <A HREF="ntsec.html#ntcheck-dump">3.1.3 DumpACL</A>
      <LI> <A HREF="ntsec.html#ntcheck-crack">3.1.4 Password cracker</A>
      <LI> <A HREF="ntsec.html#ntcheck-iss">3.1.5 ISS</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-portscan">3.1.6 TCP/IP NTPortscan</A>
      <LI> <A HREF="ntsec.html#ntsec-apps-nat">3.1.7 The NetBIOS Auditing Tool</A>
   </UL>

   <LI> <A HREF="ntsec.html#ntfw">3.2 NT based firewalls</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntfw-rapt">3.2.1 Raptor Eagle</A>
      <LI> <A HREF="ntsec.html#ntfw-fw1">3.2.2 Firewall-1</A>
      <LI> <A HREF="ntsec.html#ntfw-cat">3.2.3 The Catapult Microsoft proxy server</A>
      <LI> <A HREF="ntsec.html#ntfw-altavista">3.2.4 Digital Altavista Firewall for Windows NT</A>
      <LI> <A HREF="ntsec.html#ntfw-gauntlet">3.2.5 TIS Gauntlet</A>
   </UL>

   <LI> <A HREF="ntsec.html#ntcryp">3.3 Secure network sessions</A>
   <UL>
      <LI> <A HREF="ntsec.html#ntcryp-ssh">3.3.1 Secure Shell, SSH</A>
      <LI> <A HREF="ntsec.html#ntcryp-krb">3.3.2 Kerberos</A>
      <LI> <A HREF="ntsec.html#ntcryp-secid">3.3.3 SecureID</A>
      <LI> <A HREF="ntsec.html#ntsec-skey">3.3.4 S/Key</A>
   </UL>

   <li> <A HREF="ntsec.html#logprod">3.4 Logging products </A>
   <ul>
      <LI> <A HREF="ntsec.html#logprod-sentry">3.4.1 seNTry</A>
      <li> <a href="ntsec.html#logprod-eventslog"> 3.4.2 EventSLog </a>
   </ul>

   <li> <A HREF="ntsec.html#ntsec-file">3.5 File encryption and electronic mail </A>
   <ul>
      <LI> <A HREF="ntsec.html#ntsec-file-pgp">3.5.1 Pretty Good Privacy, PGP </A>
      <LI> <A HREF="ntsec.html#ntsec-file-mimesweep">3.5.2 MIMEsweeper </A>
      <LI> <A HREF="ntsec.html#ntsec-file-shade">3.5.3 SENTRY 2020 (former Shade) file/disk encryption</A>
   </ul>

   <LI> <A HREF="ntsec.html#otherprod">3.6 Other types of security products</A>
   <UL>
      <LI> <A HREF="ntsec.html#otherprod-ca">3.6.1 CA-UniCenter</A>
      <LI> <A HREF="ntsec.html#otherprod-radius">3.6.2 Steel-belt RADIUS server for Windows NT</A>
   </UL>
</UL> <!-- 3.0 -->


<LI> <A HREF="ntsec.html#online">4.0 Where can I find more information on NT security</A>
<UL>
   <LI> <A HREF="ntsec.html#online-ml">4.1 Mailing lists</A>
   <UL>
      <LI> <A HREF="ntsec.html#online-ml-ntsec">4.1.1 NT Security Mailing list</A>
      <LI> <A HREF="ntsec.html#online-nl-ntbugtraq">4.1.2 NTBugTraq</A>
   </UL>

   <LI> <A HREF="ntsec.html#online-web">4.2 Web pages and white papers</A>
   <UL>
      <LI> <A HREF="ntsec.html#online-web-ms">4.2.1 Microsoft</A>
      <LI> <A HREF="ntsec.html#online-web-ntr">4.2.2 NT Research</A>
      <LI> <A HREF="ntsec.html#online-web-som">4.2.4 SomarSoft</A>
      <LI> <A HREF="ntsec.html#online-web-omn">4.2.5 OMNA</A>
      <LI> <A HREF="ntsec.html#online-web-iss">4.2.6 ISS Vulnerability database</A>
      <LI> <A HREF="ntsec.html#online-web-ntshop">4.2.8 NT Shop's NT Security pages</A>
   </UL>

   <LI> <A HREF="ntsec.html#books">4.3 What books on NT security are available?</A>
</UL> <!-- 4.0 -->


<LI> <A HREF="ntsec.html#exploits">5.0 Widely known exploits, security holes and their counter measures</A>

</UL>

<hr>
<H1>
NT Security - Frequently Asked Questions version 0.41 </H1>

<H2> 
<A NAME="thefaq"> 0.0 Information related to this FAQ </A></H2>

The official home for this FAQ is currently <A HREF="http://www.it.kth.se/~rom/ntsec.html">The
Royal Institute of Technology, http://www.it.kth.se/~rom/ntsec.html</A>

<P>It will probably move to Incolumitas future WWW-server, whenever we
feel that there is a web server that is secure enough and we got the time
to set it up.
<H3>
<A NAME="legal"></A>0.1 Legaleeze</H3>
First off, unfortunately, I must include this goobedygook.
<LI>
This text is not an endorsement for any product.

<LI>
Nor is it a cookbook to be used by crackers to gain access to Windows NT
systems. The text tries to shed some light at security related issues
and problems with Windows NT. Microsoft, and more especially, their technical
writers and sales forces, often leave out several key words and key information
when describing Windows NT.

<LI>
The document is mainly a collection of pointers to other information already
available, if you know where to look.

<LI>
I am in no way affiliated with Microsoft

<LI>
All trademarks, etc. are honored. Microsoft probably is the biggest holder
of trademarks in this document. To keep them happy and their lawyers unhappy,
I'll include extra blurb for them here. Microsoft is the keeper of the
following trademarks, amongst others, e.g. product names:

<UL>
<LI>
Microsoft, Windows, Windows NT, MSN, the Microsoft Network
</UL>

<LI>
All included material are copyrighted by their respective owners/copyright
holders.


<P>This compilation is copyrighted material. Copyright &copy; 1996, 1997
Robert Malmgren. You are hereby granted a permission to use the material
for non-commercial purposes as long as you keep this copyright message,
not pretend that you wrote the material and give me and/or the other contributors
proper credits.

<P>
<HR WIDTH="100%">
<H3>
<A NAME="conv"></A>0.2  Conventions used in this document </H3>
<LI> Links to all kind of protected pages where you have to be a
member of some exclusive club of any sort, such as the Microsoft MSDN
Online, is denoted with three dollar signs. Example: <a
href="http://foo.bar.bletch/">$$$: Exclusive Members Only</a> 

<P>
<HR WIDTH="100%">
<H3>
<A NAME="update"></A>0.3 Current version and updating information</H3>
The current version number of the FAQ is 0.41 The FAQ was last updated
29th of October 1997.

<P>Please submit contributions and requests for updates to the 
<a HREF="mailto:ntsec@incolumitas.se">current maintainers</a>
(ntsec@incolumitas.se) of the FAQ. 

<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-changes"></A>0.4 Changes</H3>

Version 0.41, Oct 29, 1997
Changes to
<UL>
   <li><a href="ntsec.html#obook">1.1</a> fixed broken link
   <LI><a href="ntsec.html#ntsec-secchan">2.1.10</a> correction of inital password
   <LI><a href="ntsec.html#ntsec-host-virus">2.2.1</a> fixed broken link
   <li><a href="ntsec.html#host-pagefile">2.2.5</a> clarification
   <li><a href="ntsec.html#ntsec-apps-ie">2.8.4</a> added link
   <li><a href="ntsec.html#secpatch-4sp3">2.13.1</a> clarification of SAM encryption
   <li><a href="ntsec.html#pw">2.14</a> added general info
   <li><a href="ntsec.html#pw-service"> 2.14.1 </a> added reference to lsadump
</UL>

Version 0.40, Oct 9, 1997
<UL>
   <LI>Major changes to the whole document. 
</UL>

Version 0.39, Feb 19, 1997
<UL>
   <LI> Added <A HREF="ntsec.html#ntsec-apps-nat">3.1.7 The NetBIOS Auditing Tool</A>
   <LI> Updated <A HREF="ntsec.html#ntsec-fshare">2.6 </A> and
   <A HREF="ntsec.html#ntsec-fshare-bug">2.6.3</A> to include references to _*H's paper on attacks and problems with CIFS/SMB
</UL>

Version 0.38, Feb 16, 1997
<UL>
   <LI>Added <A HREF="ntsec.html#ntfw-gauntlet">3.2.5 TIS Gauntlet firewall</A>
   <LI>Added <A HREF="ntsec.html#ntsec-file-shade">3.5.3 Shade file/disk encryption</A>
   <LI>Added <A HREF="ntsec.html#ntsec-other-radius">3.6.2 Steel-belt RADIUS server for Windows NT</A>
   <LI>Added <A HREF="ntsec.html#online-nl-ntbugtraq">4.1.2 on the NTBugTraq mailing list</A>
   <LI>Added <A HREF="ntsec.html#online-web-ntshop">4.2.8 NT Shop's NT Security pages</A>
</UL>

Version 0.37, Jan 24, 1997
<UL>
   <LI>Added <A HREF="ntsec.html#ntsec-dos-rpc">2.5.9 </A>on the Denial-of-Service attack on RPC
   <LI>Renumbered 1.3.1 to 1.4.1 and added a 1.4
</UL>

Version 0.36, Jan 11, 1997
<UL>
   <LI>Added <A HREF="ntsec.html#ntsec-reg-hk-drop">2.3.1 </A>on HKEY_LOCAL_MACHINE
   <LI>Fixed some spelling errors
</UL>

Version 0.35, Jan 4, 1997
<UL>
   <LI>Added <A HREF="ntsec.html#ntsec-ntsecmaillist">1.3.1 </A>on ntsecurity@iss.net
</UL>

Version 0.34, 1997-Jan-01
<UL>
   <LI>Started to add URLs as text, not only as links. Makes the FAQ more useful when used in a printed form.
   <LI>Added more links to paragraph <A HREF="ntsec.html#crypto">1.2</A>, <A HREF="ntsec.html#gensec">1.3</A>
   <LI>Changed
      <A HREF="ntsec.html#legal">0.1</A>,
      <A HREF="ntsec.html#credits">0.5</A>,
      <A HREF="ntsec.html#nt-servpack">2.0.1</A>,
      <A HREF="ntsec.html#ntsec-nt-impersonation">2.0.2</A>,
      <A HREF="ntsec.html#ntsec-nt-sid">2.0.3</A>,
      <A HREF="ntsec.html#ntsec-usr-gst">2.4.2,</A>
      <A HREF="ntsec.html#ntsec-fs-cifs">2.6.1</A>
   <LI>Changed
      <A HREF="ntsec.html#ntsec-apps-www">2.7.1</A> to include the "GET ../.." bug
   <LI>Changed
      0.4 to hyper link all listed changes to the changed paragraphs.
   <LI>Added
      <A HREF="ntsec.html#ntsec-privileges">2.0.4</A>,
      <A HREF="ntsec.html#ntsec-ACLs">2.0.5</A>,
      <A HREF="ntsec.html#ntsec-ACEs">2.0.6,</A>
      <A HREF="ntsec.html#ntsec-secclient">2.1.4</A>,
      <A HREF="ntsec.html#ntsec-skey">3.3.4</A>
</UL>

Version 0.33, 1996-Dec-24
<UL>
   <LI>Changes to <A HREF="ntsec.html#books">5.0</A>
</UL>

Version 0.32, 1996-Nov-09
<UL>
   <LI>Changes to <A HREF="ntsec.html#ntsec-net-ping">2.5.8</A>
</UL>

Version 0.31, 1996-Nov-08
<UL>
   <LI>
   Updated all sections that contain links to Microsofts Knowledge Base. Since
   Microsoft have changed their file structure and naturally the links that
   points to the articles, we have to follow it. Please report broken links
   to the maintainer.
</UL>

Version 0.30, 1996-Nov-07
<UL>
   <LI>Added <A HREF="ntsec.html#ntsec-changes">0.4</A>, <A HREF="ntsec.html#ntsec-other-security">3.6</A>
</UL>

Version 0.29, 1996-Nov-07
<UL>
   <LI>Changed <A HREF="ntsec.html#obook">1.1</A>
   <LI> Added
      <A HREF="ntsec.html#ntsec-nt-impersonation">2.1.2</A>,
      <A HREF="ntsec.html#ntsec-nt-sid">2.0.3</A>,
      <A HREF="ntsec.html#ntsec-fs-ntfsread">2.2.3</A>,
      <A HREF="ntsec.html#ntsec-nt-netstat">2.6.7</A>
</UL>

<HR WIDTH="100%">
<H3>
<A NAME="credits"></A>0.5 Credits</H3>

<UL>
   <LI>
   Posters to the NT-security mailing list &lt;<A HREF="mailto:
   ntsecurity-request@iss.net">ntsecurity-request@iss.net</A>>.All texts
   posted to the list is included by kind permissions of their respective
   author.

   <LI>
   People who have gotten texts included in this FAQ are

   <P>Dan Shearer &lt;<A HREF="mailto: itudps@lux.levels.unisa.edu.au">itudps@lux.levels.unisa.edu.au</A>>
   <BR>David LeBlanc &lt;<A HREF="mailto: dleblanc@iss.net">dleblanc@iss.net</A>>
   <BR>Larry Buickel &lt;<A HREF="mailto: larry@austin.ibm.com">larry@austin.ibm.com</A>>
   <BR>Mikko Hermanni Hypp&ouml;nen &lt;<A HREF="mailto: Mikko.Hypponen@DataFellows.com">Mikko.Hypponen@DataFellows.com</A>>
   <BR>Patrik Carlsson &lt;<A HREF="mailto: patrik@netman.se">patrik@netman.se</A>>
   <br>Paul Ashton &lt;<a href="mailto: paul@argo.demon.co.uk">paul@argo.demon.co.uk</a>>
   <br>Carl Byington &lt;<a href="mailto:carl@five-ten-sg.com">carl@five-ten-sg.com</a>>
   <BR>Ondrej Holas &lt;<A HREF="mailto:oholas@digi-trade.cz">oholas@digi-trade.cz</A>&gt;
</ul>

<H2>
<HR WIDTH="100%"><A NAME="defs"></A>1.0 Definitions and general security
issues</H2>

<H3>
<A NAME="obook"></A>1.1 Orange book, red book and C2 security</H3>
The so called orange book is part of the DoD "rainbow" series of books.
The official name is <I>Department of Defense Trusted Computer System Evaluation
Criteria</I>. There is another book, a red one, which is a "interpretation"
of the Orange Book. The NCSC has published a number of different interpretations
of the TCSEC. These interpretations clarify Orange Book requirements with
respect to specific system components. The formal name of the red book
is <I>the NCSC's Trusted Network Interpretation of the Trusted Computer
System Evaluation Criteria. </I>It is an interpretation of Orange Book
security requirements as they would be applied to the networking component
of a secure system. The Red Book does not change the original requirements,
it simply describes how a network system should operate in order to meet
Orange Book requirements for a C2 secure system.

<P>Microsoft had a certain version of Windows NT, with a specific configuration,
on a specific hardware platform evaluated by NSA. The outcome was that
that specific setup is considered C2 compliant and the NSA guys from the
National Computer Security Center, NCSC, also wrote a report entitled <I>the
NSA?s Final Evaluation Report on Microsoft. Inc.: Windows NT Workstation
and Server Version 3.5 with U.S. Service Pack 3. National Computer Security
Center, 23 June 1995.</I>

<P>The people at National Computer Security Center have an <A HREF="http://www.radium.ncsc.mil/tpep/epl/entries/CSC-EPL-95-003.html">online
description of the Microsoft NT evaluation</A>, (http://www.radium.ncsc.mil/tpep/epl/entries/CSC-EPL-95-003.html)
including information on what type of hardware was used during the test.
They have an <A HREF="http://www.radium.ncsc.mil/tpep/">general page on
evaluation </A>,http://www.radium.ncsc.mil/tpep, and a <A HREF="http://www.radium.ncsc.mil/tpep/process/faq.html">frequently
asked question, FAQ</A>, area (http://www.radium.ncsc.mil/tpep/process/faq.html).

<P><I>The evaluation was just according to the orange book, not the red
book. Microsoft has since them continued the evaluation process to also
match the red book (i.e. networking parts) criterias, but this is not yet
finalized.</I>

<P>To have a C2 compliant setup, you must amongst other things have
<UL>
<LI>
Identification and Authentication mechanisms

<LI>
Discretionary Access Control mechanisms

<LI>
Auditing

<LI>
Object Reuse
</UL>
In practice, it also means that you have to
<UL>
<LI>
Turn off networking completely (since NT is just evaluated to the orange
book, not the red)

<LI>
Disable floppy disk

<LI>
Change the standard file system permissions to be more restrictive

<LI>
Change a lot of permissions in the registry
</UL>
That leaves you a not so usable client-server system. There is a tool that
come with the resource kit called <A HREF="ntsec.html#ntsec-host-c2">c2config</A>
that you might use to harden your system to a C2 level. You might also
want to see Microsoft's web page entitled
<A HREF="http://www.microsoft.com/syspro/technet/boes/winnt/nt351/c2bltn.htm">
What is C2 Evaluation? Microsoft Sets the Record Straight </A>
(http://www.microsoft.com/syspro/technet/boes/winnt/nt351/c2bltn.htm).

<P>There is an <A HREF="http://www.pinsight.com:80/~royg/security/dod/rainbow.html">on-line
html version</A> (http://www.pinsight.com:80/~royg/security/dod/rainbow.html)
available of the rainbow series books that you might want to check out.
Microsoft has a blurb that describes the <A HREF="http://www.microsoft.com/ntserver/c2char.htm">characteristics
of a secure system - C2 and beyond </A>(http://www.microsoft.com/ntserver/c2char.htm).

<P>There is a paper on a new information technology security standard called
<A HREF="http://csrc.ncsl.nist.gov/nistpubs/cc/">common criteria </A>(http://csrc.ncsl.nist.gov/nistpubs/cc)
that is available on-line. It is a proposed ISO-standard.

<P>
<HR WIDTH="100%">
<H3>
<A NAME="crypto"></A>1.2 Crypto</H3>
Cryptography is one of the foundations for much of the new computer security
mechanisms. It provides protection from interception of clear text data
including: passwords, network packets, and storage (DASD and RAM). Crypto techniques
are also used for checksums, integrity control, etc.

<P>The following links might be useful to read up on crypto issues:
<UL>
<LI>
RSA has a neat <A HREF="http://www.rsa.com/rsalabs/newfaq">FAQ on crypto
issues</A> (http://www.rsa.com/rsalabs/newfaq) you might want to look at.

<LI>
Consensus has a FAQ on the<A HREF="http://www.consensus.com/security/ssl-talk-faq.html">
Secure Socket Layer, SSL </A>(http://www.consensus.com/security/ssl-talk-faq.html)

<LI>
U.S Navy has a nice page called <A HREF="http://www.itd.nrl.navy.mil:80/ITD/5540/ieee/cipher/cipher-crypto-stds.html">Introduction
to cryptographic standards</A>

<LI>
Helsinki University have a number of nice web pages such as

<UL>
<LI>
<A HREF="http://www.cs.hut.fi/ssh/crypto/">International Cryptographics
Software Pages for Encryption, Decryption, Cryptanalysis, Steganography
and related methods</A> (http://www.cs.hut.fi/ssh/crypto)

<LI>
A neat <A HREF="http://www.cs.hut.fi/ssh/crypto/intro.html">introduction
to cryptography</A> (http://www.cs.hut.fi/ssh/crypto/intro.html)

<LI>
A collection of <A HREF="http://www.cs.hut.fi/crypto/software.html">pointers
to crypto software</A> (http://www.cs.hut.fi/crypto/software.html)
</UL>

<LI>
A list of <A HREF="http://www.zoo.net/~marcnarc/PKI/">Public Key Infrastructure
References </A>with pointers to resources on the net

<LI>
The U.S. <A HREF="ftp://hubert.wustl.edu/pub/armycryp.zip">Army crypto
manual i</A>s available on-line (ftp://hubert.wustl.edu/pub/armycryp.zip)

<LI>
You might want to check out my <A HREF="http://www.it.kth.se/~rom/cryptopeople.html">collection
of famous or interesting people in the history of cryptography</A>
</UL>

<HR WIDTH="100%">
<H3>
<A NAME="gensec"></A>1.3 Where do I get generic security information?</H3>
You might want to check out some places on the net and subscribe to some
mailing lists.

<P>Check out the following web pages:
<UL>
<LI>
<A HREF="http://www.cert.org">The Computer Emergency Response Team, CERT</A>
(http://www.cert.org)

<LI>
<A HREF="http://ciac.llnl.gov">U.S. DOE Computer Incident Advisory Capability,</A>
CIAC (http://ciac.llnl.gov)

<LI>
<A HREF="http://www.first.org/first">Forum of Incident Response Teams,
FIRST</A>, (http://www.first.org/first)

<LI>
<A HREF="http://www.telstra.com.au/info/security.html">Telstra's security
pages </A>(http://www.telstra.com.au/info/security.html)

<LI>
<A HREF="http://www.cs.purdue.edu/coast/coast.html">COAST home page</A>
(http://www.cs.purdue.edu/coast/coast.html)
</UL>
Recommended mailing lists
<UL>
<LI>
CERT advisories &lt;<A HREF="mailto:cert-advisory-request@cert.org">cert-advisory-request@cert.org></A>

<LI>
Best-of-Security (BoS) &lt;<A HREF="mailto:best-of-security-request@suburbia.au">best-of-security-request@suburbia.au></A>

<LI>
BugTraq <A HREF="mailto: listserv@netspace.org">&lt;listserv@netspace.org></A>
send a <I>subscribe bugtraq</I> in the message body.
</UL>
Check out the Security Mailing lists FAQ for more information on what lists
that is available.

<H2>
<HR WIDTH="100%"><A NAME="ntsec"></A>2.0 Questions and answers on NT security</H2>

<h4>
<a name="qna-mscontact">2.0.1 How do I contact Microsoft on security issues?</a></h4>

Microsoft have a mail alias which everyone can use to send questions,
alerts, bug reports, etc. According to Microsoft, members from
development teams participate on an internal mail exploder.

The mail address is <a href="mailto:secure@microsoft.com">secure@microsoft.com</a>

Get their <a href="http://www.microsoft.com/security/pgpkeys.txt">PGP-keys here</a> (http://www.microsoft.com/security/pgpkeys.txt). For information on PGP, see the <a href="ntsec.html#ntsec-file-pgp">PGP-section</a> in this FAQ.



<hr><h3>
<a name="security-model">2.1 Security model</a></h3>

<H4>
<A NAME="nt-servpack"></A>2.1.1 Where do I get patches, or, what is a Service
Pack or a Hot Fix?</H4>
Microsoft have an on-line database, called the software library, with program
fixes for both the NT operating system as well as applications. In Microsoft
lingo a patch or program fix is called <I>service pack</I> (SP). There are a
number of service packs out, both for different versions of Windows NT
as well as applications such as SNA server. 

<p>Service packs are cumulative. This means that SP2 contains all of
SP1 as well as the fixes introduced in SP2. Service packs often update
a great amount of code by replacing major DLLs. Since most large
applications (such as back office and development components) bring
their own versions of "system" DLLs, service packs has to be applied
after each and every "system update", where the term "system update"
is not clearly defined. Any action that replaces any component updated
by a service pack or hotfix has to be followed by applying latest SP
and all hotfixes. Remember that adding hardware often install new
software, which may have to be updated by SP and/or hotfix.

<p><i>Hot fixes</i> are intermediate fixes released between service
packs and are not considered fully regression tested, and as such not
recommended by Microsoft to be applied unless one really need the
feature they provide. Lately, a bunch of security problems have been
solved by means of releasing hot fixes.

<p> Another thing on the subject is language or locale. If you are
running a non US version of NT, you will not be able to apply all of
the hotfixes. Some of them are not language dependent, while others
refuse to install on anything else but a US version. If you have the
option to do so, run US version of NT at least on your servers. By
doing so, you will have the option of installing a hot fix dealing
with a security problem immediately when it's released and not have to
wait for the next SP to appear. Not to mention that you'd have to wait
for the next SP to be ported to <i> your </i> language, which of
course may take a while, the time depending on what language you are
using.

<P>If you cannot, or do not want to, download software like this from the
net, you can contact your local Microsoft representant and ask them about
the service pack you need.

<P>Visit <A
HREF="http://www.microsoft.com/isapi/support/bldqpage.idc?ProductPage=q_servpk&ProductTitle=Windows+NT+Service+Packs">Microsofts
library of service packs</A> or go directly to their 
<a href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes">FTP
server</a>.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-nt-impersonation"></A>2.1.2 What is impersonation?</H4>
Impersonation is the ability of a thread to execute in a security context
other than from that of the process that owns the thread. This enables
a server to act on behalf of a client to access its own objects.

<P>For more information, see
<UL>
<LI>
Microsofts <A HREF="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_16.htm">article
on impersonation</A>

<LI>
<A HREF="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/enum/src/enums_12.htm">The
different levels of impersonation</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-nt-sid"></A>2.1.3 What is a SID (Security ID)?</H4>
SID stands for <I>Security Identifier</I> and is an internal value used
to uniquely identify a user or a group.

<P>A SID contain
<UL>
   <LI> User and group security descriptors
   <LI> 48-bit ID authority
   <LI> Revision level
   <LI> Variable subauthority values
</UL>

For more information, see
<UL>
   Microsoft SDK documentation:
      <li> <a href="http://premium.microsoft.com/msdn/library/sdkdoc/accctrl_416b.htm">
      $$$:  Well-Known SIDs </a>
      (http://premium.microsoft.com/msdn/library/sdkdoc/accctrl_416b.htm) 

      <li> <A HREF="http://premium.microsoft.com/msdn/library/sdkdoc/accctrl_26wj.htm">
      $$$: SID Components </A>
      (http://premium.microsoft.com/msdn/library/sdkdoc/accctrl_26wj.htm) 
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-privileges"></A>2.1.4 What are privileges (user rights)?</H4>
A privilege is used to control access to a service or object more strictly
than is normal with discretionary access control.

<P>For more information, see
<UL>
<LI>
Microsofts article on <A HREF="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_15.htm">Privileges
</A>(http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_15.htm)
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-ACEs"></A>2.1.5 What is an ACE (Access Control Entry)?</H4>
Access-Control Entries that is used to build Access-Control Lists (ACLs).

<P>Each ACE contains the following information:
<UL>
<LI>
A SID, that identifies the trustee. A trustee can be a user account, group
account, or a logon account for a program such as a Windows NT service.

<LI>
An access mask specifying access rights controlled by the ACE.

<LI>
Flags that indicates the type of ACE and flags that determine whether other
objects or containers can inherit the ACE from the primary object to which
the ACL is attached.
</UL>
For more information, see
<UL>
<LI>
Microsofts article on <A HREF="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_10.htm">Access-Control
Entries, ACEs </A>(http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_10.htm)
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-ACLs">2.1.6 What is an ACL (Access Control List)?</A></H4>
An ACL is a list of <a href="ntsec.html#ntsec-ACEs">ACEs</a>.
<p>
For more information, see
<UL>
<LI>
Microsofts article on <A HREF="http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_9.htm">Access-Control
Lists, ACLs </A>(http://www.microsoft.com/msdn/sdk/platforms/doc/sdk/win32/sys/src/security_9.htm)
</UL>


<HR WIDTH="100%">
<H4>
<A NAME="ntsec-SRM"></A>2.1.7 What is SRM (Security Reference Monitor)?
</H4> 
The Security Reference Monitor is the kernel mode component that does the 
actual access validation, as well as audit generation.

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-LSA"></A>2.1.8 What is LSA (Local Security Authority)?
</H4> 

LSA stands for Local Security Authority. This is an internal subsystem
(as opposed to an environmental ditto, such as Win32) within Windows
NT that "generates access tokens [...], manages the local security
policy, and provides interactive user authentication services" (from
"Windows NT resource guide", ISBN 1-55615-653-7).

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-SAM"></A>2.1.9 What is SAM (Security Account Manager)?
</H4> 

SAM stands for Security Account Manager and is the one who maintains
the security database, stored in the registry under HKLM\SAM. It
serves the Local Security Authority (LSA) with SIDs. The SAM maintains
the user account database.

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-secchan"></A>2.1.10 What is a secure channel?
</H4> 

There is some confusion on this point when you consult the Microsoft
sources on the subject. Ever since MS discovered the Internet, a
secure channel is any point-to-point network connection established
between a client and a server that "provides privacy, integrity, and
authentication"
(see <A HREF="http://premium.microsoft.com/msdn/library/bkgrnd/f19d/f1a1/d1b1/s56c3.htm#sec48">
$$$: Microsoft Internet Security Framework: Answers to Frequently
Asked Questions </A>).

<P>
"Before Internet", a secure channel was (and still is) the magic
connection between WNT computers in a domain. This kind of channel is
used for transportation of sensitive data, such as user credentials
during a domain logon and replication of the account database between
DCs.

<P>
The secure channel is established as soon as the domain member machine
is booted and is based on a shared secret that is used as the key for
encrypting the data that travels through the channel.  Each domain
member has a machine account defined in the domain SAM database that
is created when the machine joins the domain. The password of this
account is used as the shared secret for encryption of the
channel. The member machine stores it in the registry, where it can be
retrieved using the
<A HREF="http://listserv.ntbugtraq.com/SCRIPTS/WA-NTBT.EXE?A2=ind9708&L=ntbugtraq&P=R627">
lsadump </A> program by Paul Ashton &lt;<a href="mailto: paul@argo.demon.co.uk">paul@argo.demon.co.uk</a>>.

<P>
A problem with this is that the initial password (on a WS account) is
poorly chosen (unicode(machine-name)). This means that anybody that
can listen in to the network at the time of a domain join will be able
to calculate the session key used to encrypt the channel, and by this
can get hold of the user credentials of anybody doing a network logon
from that particular machine.  The password is changed as soon as the
machine is rebooted after joining the domain and then periodically
changed every 7:th day, but the new password is communicated through
-- guess what -- the now not so secure channel, so as long as the
listener keeps his ear on the wire, he will have the session key. No
known solution, but the algorithm for encrypting the new password is
not published (yet).

<P>
More on the subject of secure channels:
<UL>
<LI> Paul Ashton and
Luke Kenneth Casson Leighton &lt;<a href="mailto:lkcl@switchboard.net">lkcl@switchboard.net</a>&gt; 
describes the 
<A HREF="http://listserv.ntbugtraq.com/SCRIPTS/WA-NTBT.EXE?A2=ind9708&L=ntbugtraq&P=R1566">
NT domain authentication protocol </A>
(http://listserv.ntbugtraq.com/SCRIPTS/WA-NTBT.EXE?A2=ind9708&L=ntbugtraq&P=R1566)

<li> More on the subject by 
Luke Kenneth Casson Leighton:
<a href="http://cb1-gw.cb1.com/~lkcl/ntdomain.html">NT Domain Authentication Protocol</a>
(http://cb1-gw.cb1.com/~lkcl/ntdomain.html).

<LI> <A HREF="http://www.microsoft.com/kb/articles/q154/5/01.htm">
How to Disable Automatic Machine Account Password Changes </A>
(http://www.microsoft.com/kb/articles/q154/5/01.htm)

<LI> <A HREF="http://www.microsoft.com/kb/articles/q128/4/89.htm"> 
Inter-Domain Trust Account Passwords </A>
(http://www.microsoft.com/kb/articles/q128/4/89.htm)

<li> <a href="http://www.microsoft.com/kb/articles/q139/6/08.htm">
SMB Traffic During Windows NT Domain Logon </a>
(http://www.microsoft.com/kb/articles/q139/6/08.htm)
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-logon">2.1.11 How does the logon process work? </A>
</H4> 

See 
<ul>
<li> <a href="http://www.microsoft.com/kb/articles/q122/4/22.htm">
Q122422: Example of a Remote Logon with Windows NT Server</a>
(http://www.microsoft.com/kb/articles/q122/4/22.htm)

<li> <a href="http://www.microsoft.com/kb/articles/Q102/7/16.htm">
Q102716: User Authentication with Windows NT </a>
(http://www.microsoft.com/kb/articles/Q102/7/16.htm)

</ul>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-access-token"> 2.1.12 What is an access token? </A>
</H4> Each process has an associated access token which is used by the
system to verify whether the process should be granted access to a
particular object or not. The access token consists of a user SID, a
list of group SIDs representing the groups the user belongs to, and a
list of user rights (privileges) the user is blessed with.

<HR WIDTH="100%">
<H4>
<A NAME="secmod-pw"> 2.1.13 What about passwords? </A> </h4>
See <a href="#pw">2.14</a>

<HR WIDTH="100%">
<H3>
<A NAME="ntsec-host"></A>2.2 Host security</H3>
In general, any computer that is not physically secured is not fully secured.
If anyone is able to get access to the machine, it is possible to boot
it from a diskette, CD-ROM or just steal the hard disk and use it in another
computer.

<hr><H4>
<A NAME="ntsec-host-virus"></A>2.2.1 Are there any NT based viruses, or can NT be susceptible for other viruses?</H4>
Symantec has a nice web page called <A HREF="http://www.symantec.com/avcenter/reference/vbnt.html">Understanding
Virus Behavior in the Windows NT Environment</A>. (http://www.symantec.com/avcenter/reference/vbnt.html)

<P>Some types of viruses, such as those written in a high-level language
such as Java, MS Word scripting language, Excel macros, etc, will be able
to perform some tricks on a NT machine as well.

<P>According to DR Solomon, the MS Word based concept virus spread widely
in part because several companies, including Microsoft, have shipped CD-ROMs
containing the virus.

<P>Windows NT machines can be affected by other types of viruses if you
use, for example, dual boot to run some other type of operating system
on the same hardware, e.g. OS/2, UNIX or other version of Windows. When
using a coexisting, bootable operating system, if you have a virus in effect
that destroy the boot sector or something like that, your NT partition
will probably be destroyed as well.

<P>Mikko Hermanni Hypp&ouml;nen <A HREF="mailto: mikko.hypponen@Datafellows.com">&lt;Mikko.Hypponen@DataFellows.com></A>
pointed out that
<UL>"many old DOS viruses work fine in a DOS box under NT. Most old boot
viruses will prevent NT from booting and might give a 'inaccessible boot
device' error. "</UL>
Since Windows NT machines are used as file servers for other systems, such
as MS-DOS, Windows 3.X and other clients, there are a number of NT-based
anti-virus programs. Some of them are
<UL>
<LI>
<A HREF="http://www.sophos.com/Marketing/ntgui.html">Sophos SWEEP for Windows
NT</A> (http://sophos.com/Marketing/ntgui.html)

<LI>
<A HREF="http://www.drsolomon.com">WinGuard from DR Solomon</A> (http://www.drsolomon.com)

<LI>
<A HREF="http://www.symantec.com/nav/fs_nav20nt.html">Symantec's Norton
Antivirus for NT</A> (http://www.symantec.com/nav/fs_nav20nt.html)

<LI>
<A HREF="http://www.datafellows.com">Datafellows F-PROT </A>(http://www.datafellows.com)
</UL>

Windows NT is susceptible of application based macro viruses. A well-known example of this is 
word based macro viruses.

<p>For more information, 
<ul>
	<li>visit Microsoft information page on macro viruses called <a href="http://www.microsoft.com/word/freestuff/mvtool/virusinfo.htm">Macro Virus Protection Tool Information Page</A> (www.microsoft.com/word/freestuff/mvtool/virusinfo.htm)
	<li><a href="http://www.ncsa.com/virus/alerthoax.html">NCSA Virus Lab alerts and hoaxes</a>
</ul>


<HR WIDTH="100%">
<H4>
<A NAME="ntsec-host-c2"></A>2.2.2 How do I get my computer C2-level secure,
or, what is c2config?</H4>
On the CD-ROM that is included in the NT Resource Kit, there is a program
called c2config that can be used for tighten the security of a NT based
computer.

<P>Be aware, that c2config will not work well on systems with localized
environment, e.g. a german NT that uses ACLs in german, not in english.

<P>See also Microsoft's web page entitled
<A HREF="http://www.microsoft.com/syspro/technet/boes/winnt/nt351/c2bltn.htm">
What is C2 Evaluation? Microsoft Sets the Record Straight</A>
(http://www.microsoft.com/syspro/technet/boes/winnt/nt351/c2bltn.htm).

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-ssave"></A>2.2.3 Are there any known problems with the screen
saver / screen lock program?</H4>
Yes. In version 3.5 and 3.51, if the administrator decide to kick a user
off, then the admin has a small time window to see the content of the users
current screen and desktop.

<P>See article <A HREF="http://www.microsoft.com/kb/articles/q130/9/32.htm">Q130932
</A>in the Knowledge Base.

<P>Another problem is that a tool from the Resource kit might be (miss-)used
to deactivate the screen saver on a remote computer. See article <A HREF="http://www.microsoft.com/kb/articles/q142/0/18.htm">Q142018
</A>on shutdown.exe in the Knowledge Base.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-secclient"></A>2.2.4 How can I secure my client computers
against my users?</H4>
One way to make it harder for the local user to do any harm to the system
is to have a local PC without any hard disk or floppy disk. To boot, the
system will need to talk to a boot server over the network.

<P>Check out Dan Shearer's document on<A HREF="ftp://lux.levels.unisa.edu.au/pub/doc/RemoteBoot.txt">
remote boot</A> (ftp://lux.levels.unisa.edu.au/pub/doc/RemoteBoot.txt)

<p> In the case that you <em> do </em> have a hard disk, mandatory profiles is a
way of restricting the users access to the computer. A couple of things
pointed out by David LeBlanc in a posting to the NT Security mailing
list: 
<ul> 
   <li> Remove the execute right from the inheritance ACL of each
   directory where the user can create files.  This way, any file that
   the user in one way or another after all managed to create on the disk
   would be impossible to execute. 
   
   <li> If the machine has a mail reader installed on it, make sure that
   the mailer is configured to not allow running of any executables attached
   to a mail. 

</ul>   

<hr width="100%"><h4>
<A name="host-pagefile">2.2.5 Can my page file hold sensitive data? </a></h4>

It can. Memory pages are swapped or paged to disk when an application
needs physical memory. Even though the page file (see Control
Panel->System->Performance->Virtual Memory) is not accessible while
the system is running, it can be accessed by, for example, booting
another OS.

<p>There is a registry key that can be created so that the memory manager clears the page file
when the system goes down:
<ul> HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\MemoryManagement\ClearPageFileAtShutdown: 1
</ul>
<p>Note that the clearing of the page file only is done when the system is brought down
in a controlled fashion. If the machine is just switched off or brought down in any
other brute way, of course no clearing will be performed.

<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-fs"></A>2.3 File system</H3>
As shipped from Microsoft, most versions of NT I've ever encountered have
had very weird access control list settings on the system files and directories.
A lot of files and directories have had "Everyone" with "full control"
capabilities. This is true for both NT 3.51 and 4.0.

<P>One way to examine which files that have strange permissions are to
use SomarSoft's <A HREF="ntsec.html#ntcheck-dump">DumpACL </A>program.

<P>David LeBlanc <A HREF="mailto: dleblanc@iss.net">&lt;dleblanc@iss.net>
</A>has written a text on file permission:
<UL>If you want to really lock something down hard, then you set the root
directory to full access for administrators and system, list access to
users (not Everyone). Let that work all the way down the tree. You then
go in and loosen things up as need be, but what you've just done is ensure
that any new directory that gets created will have those permissions. You
then need to make sure the print spool directory has full access to creator\owner
(see the NT Resource Kit, 3.51 Update 1 (also known as vol 5)). I'd also
go through (using cacls, or you can use the search facility of either file
manager or explorer) and set the permissions on all of the executables
and DLLs to full access to admins (or if people normally work on that machine
under admin status, remove write permission for admins), and list only
(read-execute) permissions to users. Note that you've just made it difficult
for users to install any software. This could be good or bad, depending
on what you want to do. You could make a list of common DLLs that are updated
often and give users delete permission.

<P>Now you apply the "smoke test" - log in as a user, and see what is broken.
Some programs insist on being able to write to an .ini file in the system
tree - if users can't write to (or create) these files, these programs
will fail. Change the permissions as need be. If you go overboard, you
can even get a situation where non-admins either can't successfully log
in, or get a desktop that is completely blank (I did this, much to my astonishment).

<P>If you want to allow users to store file locally, make sure that they
have full rights to their own directories. Note that under NT 4.0, a user's
desktop profile, and numerous other things are stored under the system
tree - look in %systemroot%\profiles, and make sure each user has full
rights to their subdirectory - it should be admin, system, and user have
full access.

<P>You'll also want to loosen up the temp directory - a good thing is to
give users list access, but creator\owner full access. There may be other
directories that need work, depending on what apps you have, and whether
they have any notion of multiple users - one example would be the cache
directory for your browser.

<P>Since people have a lot of different needs, there is no single answer
- it depends on your environment.</UL>
Examples of things that might break when one tighten file permission security
includes
<UL>
<LI>
Various applications

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q133/4/88.htm">The UNIX line
printer client lpr</A> (http://www.microsoft.com/kb/articles/q133/4/88.htm)

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q130/0/16.htm">The virtual
memory (VM) system</A><A HREF="http://www.microsoft.com/kb/bussys/winnt/q130016.htm">
</A>(http://www.microsoft.com/kb/articles/q130/0/16.htm)

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q109/0/76.htm">Boot </A>(http://www.microsoft.com/kb/articles/q109/0/76.htm)
</UL>
<B><I>Microsoft has an article with ID<A HREF="http://www.microsoft.com/kb/articles/q153/0/94.htm">Q153094
</A>(http://www.microsoft.com/kb/articles/q153/0/94/htm) that describes
what to do if you secure some files and change some ACLs that you should
not. Fixing Microsofts broken file system permission setup might hang your
system real bad and make it un-bootable. Read the article before actually
changing your system.</I></B>

<P>Microsoft has a salesblurb on NTFS that describes it from a<A HREF="http://www.microsoft.com/ntserver/ntfs_mb.htm">
security perspective</A>. (http://www.microsoft.com/ntserver/ntfs_mb.htm)

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-fs-reset"></A>2.3.1 I Just installed a service pack. Why
is my file permissions changed?</H4>
There are some known instances where service packs have reset permission
to the state the permissions where on the first installation.

<P>For examples, see Knowledge Base articles <A HREF="http://www.microsoft.com/kb/articles/q108/1/03.htm">Q108103</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-fs-bug1"></A>2.3.2 Why can users without permissions delete
files?</H4>
There is a known problem in 3.5, 3.51 and 4.0 versions of NT that users
might be able to delete files without permission. Check out Knowledge Base
article <A HREF="http://www.microsoft.com/kb/articles/q142/0/17.htm">Q142017</A>
on the subject

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-fs-ntfsread">2.3.3 Is it possible to read or write data
on a NTFS disk from another OS?</a></H4>
Yes. There are at least two different OSes that is capable of this, MS-DOS
and Linux.

<P>It is possible to use the NTFSDOS.exe program from MS-DOS to read information
of a NTFS formatted disk.


<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-reg"></A>2.4 Registry</H3>
As shipped from Microsoft, most versions of NT have very weird access control
list settings on the system registry keys. Some registry keys have had
permissions that let everyone access and change them over the network.

<P>Dan Shearer <A HREF="mailto: itudps@lux.levels.unisa.edu.au">&lt;itudps@lux.levels.unisa.edu.au></A>
wrote in message &lt;"ydd1N.0.UA4.0BSJo"@suburbia> dated Sat, 28 Sept 1996
14:05:28 +0930
<UL>> here's some more:
<BR>> ppl can read portions of the registry remotely (via regedt32.exe).

<P>By default they can _write_ to it too, at least under 3.51 the default
permissions gave Everyone write access to quite a few things. The canonical
example was (is) the key that determines the association between an application
and its extension in file manager. That can be changed by an unpriveliged,
even unknown user with access to regedt32 on a connected network. Should
the .txt entry be changed to point to:

<P>\\SomeNTorUnixWorkstation\UnprotectedShare\bogus.cmd

<P>where bogus.cmd contains:

<P>net user administrator xxxxx /y
<BR>notepad %1 %2 %2 %3 %4 %5

<P>all someone with admin privilege at the console has to do is double-click
on a text file and the admin password is changed. Of course this is a pretty
basic example because the admin would (hopefully) be suspicious on seeing
a dos box pop up. But it is trivial to write a win32 app that both launches
notepad and does some malicious trapdoor stuff with the admin privilege
it has been given.</UL>
This is true for NT 3.51.

<P>David LeBlanc &lt;<A HREF="mailto: dleblanc@iss.net">dleblanc@iss.net</A>>
has written some text on the registry
<UL>In the registry, I'd go in and remove write permission to Everyone
from HKEY_CLASSES_ROOT, and give full access to creator\owner, which is
what Microsoft did with NT 4.0 - much more secure.</UL>
Microsoft has an article in the Knowledge Base, article <A HREF="http://www.microsoft.com/kb/articles/q153/1/83.htm">Q153183
titled How to Restrict Access to NT Registry from a Remote Computer</A>
that gives some information on how to fix this very severe security problem.

<P>Playing around with permissions on objects in the registry might damage
the system. Check out the article <A HREF="http://www.microsoft.com/kb/articles/q139/3/42.htm">Q139342
Incorrect Permission in Registry Cause Unpredictable Results</A><A HREF="http://www.microsoft.com/kb/bussys/winnt/q139342.htm">
</A>from the Knowledge Base.

<p>Some applications still uses old .INI-type files for initialization, especially
ports of old Windows 3 and MS-DOS programs. Those programs might have
vulnerabilities in such way that the file protection are wrong and by that let
someone read sensitive data, such as password, or change data. 

<P>See also
<UL>
<LI>
<A HREF="ntsec.html#ntsec-apps-roll">2.7.5 Rollback.exe</A>

<LI>
The article <A HREF="http://www.winntmag.com/ns-search/articles/Oct95/REGISTRY.HTM?NS-search-set=\32565\s8l.565b92&NS-doc-offset=3&">Registry
Secrets </A>from <A HREF="http://www.winntmag.com">Windows NT Magazine</A>
(http://www.winntmag.com)
</UL>



<HR WIDTH="100%">
<H4>
<A NAME="ntsec-reg-hk-drop"> 2.4.1 Why does the HKEY_LOCAL_MACHINE key drop its settings?</A></H4>
The HKEY_LOCAL_MACHINE key is recreated by the system each time the system
is booted. This have the effect that changes in the ACLs for this key does
not persist over a reboot.

<HR WIDTH="100%">
<H4>
<A NAME="reg-remote"> 2.4.2 Is the registry accessible over the network? </A></H4>

It depends on the version and role of the computer. 
<p> In NT 3.51, the registry is remotely accessible by default.
<p> In NT 4.0, the <em> ACL on </em> the registry key 
<b> HKLM\CurrentcontrolSet\Control\SecurePipeServers\winreg </b> 
(DWORD:1) defines who can access the registry remotely. On a NT server, this key 
exists with permissions set to Administrators:Full Control, but on a workstation there is no
such key. The workstation do look for it though, so just create it and set its permissions
if this is an issue.

<HR WIDTH="100%">
<H4>
<A NAME="reg-interesting"> 2.4.3 Are there any especially interesting keys to watch? </A></H4>

The following keys are well suited for planting a back door in one way or another. 
Always ensure the ACLs on these are ok. To keep track of changes or tries to change
them, one can set up auditing on the keys as well. See <a href="ntsec.html#log-audit"> 
2.10.5 Auditing </a>.

<ul>
   <p><li> HKLM\SYSTEM\CCS\Services\LanmanServer\Parameters\NullSession{Shares|Pipes}
   <p> This keys lists shares and named pipes that are accessible without logging in to the system,
   a so called NULL session connection (see <a href="ntsec.html#fshare-nullsess"> 2.7.4 </a>).
   One scary aspect of this is that if you by coincident happen to create a share or named
   pipe which name matches any of the names in these lists, they are accessible from a NULL session
   connection.
   Note that the RestrictAnonymous key under Control/LSA mentioned in 
   <a href="http://premium.microsoft.com/support/kb/articles/Q143/4/74.asp">$$$: Q143474 </a> 
   does <em> not </em> prevent access to resources listed here.
   <p>
   On a fresh NT 4.0, the defaults are: 
   <ul>
      <li> Pipes: <sample> COMNAP, COMNODE, SQL\QUERY, SPOOLSS, LLSRPC, EPMAPPER, LOCATOR </sample> 
      <li> Shares: <sample> COMCFG, DFS$. </sample> 
   </ul>
   
   <p><li> HKLM\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages
   <p> Lists the DLLs that is to be invoked when a user change its password. The perfect point
   for a password snitcher. See <a href="#pw-notif">2.14.2</a>.
   

</ul>

<p> Please note that this is not an extensive list. There are more of these, and there
is no way of knowing when new ones appear. Any suggestions of things that would fit here
is gladly accepted. Contact the <a href:"mailto:ntsec@incolumitas.se"> current maintainer </a>
of this FAQ.

<HR WIDTH="100%">
<H3>
<A NAME="ntsec-usr"></A>2.5 User security</H3>
Users are susceptible to a number of attacks, such as dictionary password
guessing. In Windows NT, one way to protect against those types of attacks
is to set the number of failed logins before disabling the account temporary
or until the system manager manually enables it again.

<p> For more info regarding passwords in Windows NT, see <a href="#pw">2.14 Passwords</a>.

<P>David LeBlanc &lt;<A HREF="mailto: dleblanc@iss.net">dleblanc@iss.net</A>>
wrote in a mail
<UL>As to user rights, I like to go through and make sure Guest is not
only disabled, but that it has no rights to anything. Give careful attention
to who is allowed to log on from the network and locally. One thing to
consider is that the administrator account is on every machine, and can't
be locked out from too many bad passwords. A good way around this is to
remove the administrator's group from the permissions to log on from the
network, and add back in the individual users who are the admins. Now go
set it up to audit failed login attempts, lock out users for a few minutes
if there are too many login failures, and require a password of decent
length - 6 characters is acceptable. This makes brute force attacks very
difficult. If you want to prevent other users from accessing the machine
remotely, you can also remove the users from the right to log on from the
network - that confines the users to having to use the shares on the server.
This also prevents anyone not given that right from accessing the event
log, the registry, and the shares on the machine. You might also want to
pay attention to who can and cannot shut the machine down, and perhaps
make it to where you need to log in to shut it down.</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-usr-adm"></A>2.5.1 Administrator account</H4>
Microsoft recommends that you changes the name of the administrator account
so that outsiders cannot guess the name.

<P>This is of course just <em> one </em> of the things you can do. But
unlike what some Microsoft employees believe, security does not stop
there. Just changing name of administrator is to trying to protect
yourself by the lowest level of security there is, <em> security by
obscurity </em>.

<P>It is possible to obtain the new name of the administrator by using
the command
<UL>nbtstat -A &lt;ip-address></UL>
when the administrator is logged in on the console.

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-usr-gst"></A>2.5.2 Guest account</H4>
As shipped, some older versions of Windows NT had a guest account that
was easily used by outsiders. Newer versions of NT have their guest account
closed as shipped from Microsoft. Anyway, you should check out your guest
account and disable it as much as possible.

<P>Some people remove the guest account from their system, but unfortunately,
Microsoft ship some product that relies upon the usage of that account.
For example, if you use Microsoft Internet Studio in combination with Microsoft
SQL or Microsoft Access running on another computer than the one running
Internet Studio.

<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-net"></A>2.6 Network security</H3>
For some background information on Internet and Internet security, see
<UL>
<LI>
<A HREF="http://www.winntmag.com">Windows NT Magazines</A> article <A HREF="http://www.winntmag.com/ns-search/articles/Sept95/SAFE.HTM?NS-search-set=\32565\s8l.565b92&NS-doc-offset=2&">Is
the Internet a Safe Place to Live?</A>

<LI>
John Neystadt's article <A HREF="http://www.neystadt.org/winnt/site.htm">How
to Create Internet Site with Windows NT only</A>

<LI>
<A HREF="http://www.mcs.net/~thomas/www/ntfaq/">Windows NT Internet FAQ</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-synflood"></A>2.6.1 Is NT susceptible to SYN flood attacks?</H4>
Yes. To my knowledge, all IP based systems are possible victims for the
attack.

<P>According to the article in <A HREF="http://www.fc.net:80/phrack/files/p48/p48-13.html">phrack
magazine, volume 48</A>, (http://www.fc.net/phrach/files/p48/p48-13.html)
NT have a queue size of 6 outstanding SYN packets. The article will serve
as good reading if you want to understand the details of the problem.

<P>Check out
<UL>
<LI>
<A HREF="ftp://info.cert.org/pub/cert_advisories/CA-96.21.tcp_syn_flooding">CERTs
advisory CA-96.21</A> for more information about the problem.

<LI>
3<A HREF="http://www.3com.com/nsc/certwarn.html">Com's excellent article
on the problem.</A> It contain allot of pointers to more information
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-pf"></A>2.6.2 Is it possible to use packet filters on an
NT machine?</H4>
NT 4 comes with built-in support for packet filtering. It is a simple but
still usable filtering function that the administrator can configure to
just let some IP packets reach the actual applications running on the system.

<P>You find configuration panel for the filtering function on "Control
Panel->Network->TCP/IP->Services->Advanced->Security"

<P>Be aware that this simple filtering mechanism is not a substitute for
a real firewall since it cannot do advanced stuff like protection against
ip-spoofing, etc.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-net-nbt"></A>2.6.3 What ports must I enable to let NBT (NetBios
over TCP/IP) through my firewall</H4>
First of all, <B><I>you should really, really reconsider </I></B>if this
is such a good idea to let NBT traffic through your firewall. Especially
if the firewall is between your internal network and Internet.

<P>The problem with NBT is that at once you open it up through the firewall,
people will have potential access to all NetBios services, not just a selection
of them, such as printing.

<P>The following is a list of the ports used by NBT.
<UL>
<LI>
netbios-ns 137/tcp NETBIOS Name Service

<LI>
netbios-ns 137/udp NETBIOS Name Service

<LI>
netbios-dgm 138/tcp NETBIOS Datagram Service

<LI>
netbios-dgm 138/udp NETBIOS Datagram Service

<LI>
netbios-ssn 139/tcp NETBIOS Session Service

<LI>
netbios-ssn 139/udp NETBIOS Session Service
</UL>
For more information, see <A HREF="ftp://ftp.sunet.se/pub/Internet-documents/rfc/rfc1001.txt">RFC
1001</A>, <A HREF="ftp://ftp.sunet.se/pub/Internet-documents/rfc/rfc1002.txt">RFC
1002</A> and the list of <A HREF="ftp://venera.isi.edu/in-notes/iana/assignments/port-numbers">IANA
assigned port numbers</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-net-auth"></A>2.6.4 What is Authenticode?</H4>
Authenticode is a way to ensure users that code they download from the
net has not been tampered with and gives the code an etched in ID of the
software publisher. Microsoft is pushing this as a new way of getting better
security into software distribution over the net.

<P>For more information, see Microsoft's <A HREF="http://www.microsoft.com/intdev/security/authcode/signfaq-f.htm">FAQ
on Authenticode</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-net-snmp"></A>2.6.5 What should I think about when using
SNMP?</H4>
In other SNMP-enabled machines you can configure both an write and a read
community name. On a Windows NT system you can only set one. Not having
a community name does not disable the service, as one might expect. According
to David LeBlanc, &lt;dleblanc@iss.net>:
<UL>If you don't specify a community name, it will answer to anyone.</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-net-sna"></A>2.6.6 Is there any known problems with SNA?</H4>
Check out item <A HREF="ntsec.html#ntsec-apps-sna">2.8.8 on Microsoft's SNA</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-nt-netstat"></A>2.6.7 What servers have TCP ports opened
on my NT system? Or: Is netstat broken?</H4>
Normally, the netstat program should report information on the status of
the networking connections, routing information, etc. With the option -A
or -a, it should list all TCP and UDP available connections and servers
that are accepting connection. On Windows NT, even though the documentation
states otherwise, this is not the case.

<P><B><I>There are no simple way to check what services that are running
with TCP ports opened to accept connections. Currently the only way to
get some information about this is to use a port scanner program and test
through each TCP port on the NT machine. This is not a fool proof way of
dealing with the problem.</I></B>

<P><B><I>This is a serious problem if you plan to have NT based computers
in the firewall environment. You cannot easily hardened them to become
bastion hosts, since you are not confident what types of network services
that might be reachable from the outside.</I></B>

<P>It is a confirmed bug in Windows NT 3.5, 3.51 <B><I>and 4.0.</I></B>
I do not expect Microsoft to fix it soon enough.

<p><b>Update:</b><br>
netstat.exe is fixed as of NT4 SP3, but it still shows some strange behavior. For example,
on a moderately loaded machine, you can find numerous duplicates of open connections. Why is that?

<P>For more information see
<UL>
<LI>
Knowledge base articles <A HREF="http://www.microsoft.com/kb/articles/q134/4/04.htm">Q134404</A>
and <A HREF="http://www.microsoft.com/kb/articles/q131/4/82.htm">Q131482</A>

<LI>
To get more information on TCPs three way handshake and the different states
of a TCP connection, see Microsoft's paper <A HREF="http://www.microsoft.com/kb/articles/q137/9/84.htm">TCP
Connection States and Netstat Output</A>
</UL>


<hr><H4>
<A NAME="ntsec-net-ping"></A>2.6.8 What are giant packets? Or, is Windows NT susceptible to the PING attack?</H4>
There are mixed reports whether or not NT is vulnerable to this attack.
By using ping to send a large packet to certain systems, they might hang
or crash.

<P>Windows NT 3.51 seem to be vulnerable to this attack. A knowledge base
article, <A HREF="http://www.microsoft.com/kb/articles/q132/4/70.htm">Q132470,</A>
describes symptoms in Windows NT 3.51, and also include a pointer to a
patch for this problem

<P>Check out Mike Bremford's <A HREF="http://www.sophist.demon.co.uk/ping/">Ping
o' Death web page</A> (http://www.sophist.demon.co.uk/ping) for more information
on what systems are vulnerable and how.

<p><b>Update:</b>
The PoD site has moved to http://prospect.epresence.com/ping, which doesn't seem
to exist in the DNS for the moment.

<p> There is a PoD II, which utilizes a bug in the way Microsofts IP-stack assembles
fragmented IP packets.

<p>See
<a href="http://premium.microsoft.com/support/kb/articles/q154/1/74.asp">
$$$: Q154174 - Invalid ICMP Datagram Fragments Hang Windows NT, Windows95 </a>

<p>There is a fix for this, both NT4 and NT3.51, released in July 1997:
<ul>
   <li> <a href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP3/icmp-fix">NT4 icmp-fix</a>
   (ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP3/icmp-fix).

   <li><a href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT351/hotfixes-postSP5/icmp-fix">NT3.51 icmp-fix</a>
   (ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT351/hotfixes-postSP5/icmp-fix).
</ul>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-dos-rpc"></A>2.6.9 What about the denial-of-service problem
with RPC</H4>
There exists a problem with the RPC on port 135. This can be misused to
launch a denial-of-service attack against a NT system.

The example below, which uses the SAMBA package,
illustrates how this can be done

<ul>
<listing>
$ smbclient -U verylongname -M hostname
</listing>
</ul>


<P>Microsoft have issued a fix for this problem <A HREF="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP2/RPC-fix">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP2/RPC-fix</A>.

<p>This fix is included in SP3.

<hr><h4>
<a name="net-chargen">2.6.11 Chargen flooding?</a></h4>
The "Simple TCP/IP Services" service is susceptible to a denial of
service attack. See 
<a href="http://premium.microsoft.com/support/kb/articles/q154/4/60.asp">$$$: Q154460</a>.

<p>Microsoft has released a fix for this:
<a href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP3/simptcp-fix">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP3/simptcp-fix</a>.

<hr><h4>
<a name="net-winsdos">2.6.12 WINS denial of service?</a></h4>
The WINS server is susceptible to a denial of service attack. See
<a href="http://premium.microsoft.com/support/kb/articles/q155/7/01.asp">$$$: Q155701</a>.

<p>Microsoft has released a fix for this:
<a href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/hotfixes-postSP3/winsupd-fix">ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/NT40/hotfixes-postSP3/winsupd-fix</a>.


<hr><h4>
<a name="net-dhcp">2.6.13 Dynamic Host Configuration Protocol, DHCP</a></h4>

Security problems with DHCP include, but is not limited to
<ul>
	<li>Fake DHCP-servers
	<li>Non-existing logs of who used what IP-address at a certain occasion
	    in past time.
</ul>

One of the big limitations with DHCP has been the inability to log and keep a 
historical track of which machine has leased which IP-address in the past. In SP3 
Microsoft is said to have added this possibility. (Note: Not verified by 
<a href="mailto:ntsec@incolumitas.se">FAQ maintainer</a>.)

<hr><h4>
<a name="net-enumerate">2.6.14 How do I enumerate all listening named pipes? </a></h4>
Beats me. Any clue? Mail <a HREF="mailto:ntsec@incolumitas.se">ntsec@incolumitas.se</a>
<p>Same goes for RPC servers.

<hr><h4>
<a name="net-oob">2.6.15 What is the OOB (Out of Band) attack? </a></h4>
The "OOB attack" is a denial of service attack that utilizes a bug in Microsofts implementation
of its IP-stack. Source code for a program called Winnuke that does this was posted to BugTraq in
May 1997 by _eci &lt;<a href="mailto:myst@LIGHT-HOUSE.NET">myst@LIGHT-HOUSE.NET</a>&gt;.

<p>See 
<ul>
   <li> <a href="http://premium.microsoft.com/support/kb/articles/q143/4/78.asp">
   $$$: Q143478 - Stop 0A in TCPIP.SYS When Receiving Out Of Band (OOB) Data </a>
   <li> <a href="http://premium.microsoft.com/support/kb/articles/q168/7/47.asp">
   $$$: Q168747 - Update to Windows 95 TCP/IP to Address Out-of-Band Issue </a>
   <li> <a href="http://premium.microsoft.com/support/kb/articles/q173/2/41.asp">
   $$$: Q173241 - Update to Windows for Workgroups TCP/IP for Out-of-Band Issue </a>
</ul>

<p>There is a fix for this called icmp-fix, see <a href="#ntsec-net-ping">
2.6.8 What are giant packets? Or, is Windows NT susceptible to the PING attack?</a>

<hr><h4>
<a name="ntsec.html#net-fragbug">2.6.16 How does NT deal with fragmented IP packets? </a></h4>
Prior to NT4 SP3, not too good. 

<p>Due to a bug in Microsofts IP implementation, one can fool the
stack to reassemble fragmented packets in such ways that it is
possible to send arbitrary data to an arbitrary port <em> even when
the target machine is protected by a firewall.</em> There are
firewalls that prevent this by handling all reassembling before
forwarding the complete packet to the target host. It is probably wise
to check up your firewall and/or apply SP3 if not done already.


<p>Visit Thomas Lopatic's &lt;<a href="mailto:thomas@dataprotect.com">thomas@dataprotect.com</a>&gt;
page
<a href="http://www.dataprotect.com/ntfrag/">A New Fragmentation Attack</a>
(http://www.dataprotect.com/ntfrag/).


<!-- 2.7 -->
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-fshare"></A>2.7 File sharing security</H3>
For more information see
<UL>
<LI>
<A HREF="http://www.microsoft.com/kb/articles/q101/2/34.htm">How to Set
Up Share Level Security with Windows NT</A>

<LI>
<A HREF="http://avian.org/avian/papers/cifs.txt"> *Hobbit*'s paper on security
problems with file sharing (SMB/CIFS, etc)</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-fs-cifs"></A>2.7.1 What is CIFS?</H4>
CIFS stand for Common Internet File System and is a specification for a
file sharing protocol. It is based on the Server Message Block protocol,
SMB.

<P>There is a mailing list where the designers from Microsoft and the designers
of SAMBA and other network file systems discuss CIFS. Check it out on 'listserv@msn.com'.
Send the command <I>subscribe CIFS yourname</I> to subscribe. The mailing list
is archived at <A HREF="http://microsoft.ease.lsoft.com/archives/cifs.html">http://microsoft.ease.lsoft.com/archives/cifs.html</A>

<P>For more information see
<UL>
<LI>
The <A HREF="ftp://ietf.cnri.reston.va.us/internet-drafts/draft-heizer-cifs-v1-spec-00.txt">protocol
specification for Common Internet File System Protocol (CIFS/1.0)</A> (ftp://ietf.cnri.reston.va.us/internet-drafts/draft-heizer-cifs-v1-spec-00.txt)
has been submitted to the IETF
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-fshare-def"></A>2.7.2 Is it possible to turn off the default
sharing?</H4>
NT by default makes a share for each hard disk or partition. One have to
manually disable this behavior.

<P>Patrik Carlsson &lt;patrik@netman.se> gives a solution for the problem
in a mail to NT-security mailing list:
<UL>If the non-sharing of the default shares is an issue you could probably
write som sort of batch or cmd file that runs every time you start the machine
and disables the sharing. something like net share c$ /DELETE.</UL>

<p>Another way is to create the registry key <b>AutoShareServer</b> or
<b>AutoShareWks</b>, depending on the machine role, as a REG_DWORD under
<b>HKLM\System\CurrentControlSet\Services\LanmanServer\Parameters</b>
and set it to 0. Restart the Server service.

<p> Note that this does <em> not </em> prevent IPC$ to be shared! A safer bet is
to stop and disable the Server service altogether if that is an option.

<p> (Note: I have verified this a while ago, but cannot reproduce it on my 
current installation. Please report any better luck to 
<a href="mailto:ntsec@incolumitas.se">ntsec@incolumitas.se</a>.
BTW, try to search MS for the string "C$", on the web or the
MSDN Library CD.)

<p> There is a KB article <em> touching </em> the subject:
<a href="http://premium.microsoft.com/support/kb/articles/q156/3/65.asp">
$$$: Q156365 - Hidden Shares Are No Longer Available After Using System Policy</a>


<HR WIDTH="100%">
<H4>
<A NAME="ntsec-fshare-bug"></A>2.7.3 Are there any known bugs for File
sharing?</H4>
Yes.

Some good security enhancements, include
<UL>
<LI> Enable scope-id
<LI> Enable packet signing (available from NT4.0 SP3)
</UL>
<P>See <A HREF="http://avian.org/avian/papers/cifs.txt"> *Hobbit*'s excellent
paper</A> (http://www.avian.org/avian/papers/cifs.txt) on the Common Internet
File System, CIFS, and its security problems.

<hr><h4>
<a name="fshare-nullsess"> 2.7.4 What is a NULL session? </a> </h4>

A NULL session connection, also known as Anonymous Logon, is a way of
letting a not logged on user to retrieve information such as user
names and shares over the network. It is used by applications such as
explorer.exe to enumerate shares on remote servers. The sad part is
that it lets non-authorized users to do more than that. Particularly
interesting is <a href=#reg-remote>remote registry access</a>, where
the NULL session user has the same permissions as built-in group
Everyone.

<p> With SP3 for NT4.0 or a fix for NT3.51, a system administrator can restrict the
NULL session access, see
<a href="http://support.microsoft.com/support/kb/articles/Q143/4/74.asp">$$$: Q143474</a>.

With this fix, a new well-known <a href="#ntsec-nt-sid">SID</a> is
defined, named "Authenticated Users", which is Everyone except NULL
session connected users. Replacing Everyone in all ACLs on the machine
with this Authenticated User would be a good thing. To do this in a
controlled fashion, one can use cacls.exe for the file system, but
have to rely on some third party product for the registry ACLs. Using
explorer.exe/winfile.exe or regedt32.exe will most certainly break the
system. The cause for this is that these tools <em> replace </em> the
ACL instead of <em> editing </em> it.


<HR WIDTH="100%">
<H3>
<A NAME="ntsec-apps"></A>2.8 Application and subsystem security</H3>

<H4>
<A NAME="ntsec-apps-www"></A>2.8.1 Web server security</H4>
There are a number of problems with web servers. Bugs in the server, stupid
CGI scripts, erroneous configurations, strange other services (e.g. data
base connections) are just a few things that might be used to damage your
security.

<P>You might want to look at the <A HREF="http://www.telecomm.uh.edu/links/www-security-faq.html">WWW
Security FAQ</A> to get some general security information on WWW.

<P>If you install an Windows NT machine as a web server or a firewall,
you should tighten up the security on that box more that you should do
to ordinary machines on your internal network since a machine accessible
from the Internet are more vulnerable and more likely to be attacked. Securing
the machine gives you a <I>bastion host.</I> Some of the things you should
do include
<UL>
<LI>
Remove all protocol stacks except TCP/IP, since IP is the only protocol
that runs on the Internet

<LI>
Remove some network bindings

<LI>
Disable all unnecessary accounts, like guest

<LI>
Remove share permissions and default shares

<LI>
Remove network access for everyone (User Manger -> Policies -> User rights,
"Access this computer from the network")

<LI>
Disable unnecessary services (FTP, etc)

<LI>
Enable audit logging

<LI>
Track the audit information
</UL>
<I>Internet Information Server</I>

<P>Check out Andy Baron's bug reports on earlier versions of the <A HREF="http://www.omna.com/msiis">Internet
Information Server</A>. Microsoft also has some information on this bug
as well as suggestions to workaround in Knowledge Base article <A HREF="http://www.microsoft.com/kb/articles/q148/1/88.htm">Q148188.</A>

<P>Microsoft has some information on known vulnerabilities in IIS available
in Knowledge Base
<UL>
<LI>
Article <A HREF="http://www.microsoft.com/kb/articles/q142/6/31.htm">Q142631</A>
describes a problem where a users might access unwanted directories

<LI>
Article <A HREF="http://www.microsoft.com/kb/articles/q147/6/91.htm">Q147691</A>
describes a problem where Anonymous Users Have Same Access as Domain Users
in IIS
</UL>
Another bug has been found in IIS servers that will hang or kill the web
server. Sending the HTTP command "GET ../.." will hang a IIS version 2.0
server on NT 4. There are conflicting rumors whether this will work on
NT 3.51 or not.

<P>Microsoft recommend that you upgrade your IIS server to version 3.0
or the latest available version.

<p> IIS version 2.0 and 3.0 is vulnerable of a denial of service attack
using a "CGI request from a browser that contains between 4 and 8 kilobytes of data in the URL"
(cited from 
<a href="http://premium.microsoft.com/support/kb/articles/q143/4/84.asp">
Q143484 - IIS Services Stop with Large Client Requests</a>). 

<p>A fix can be found at 
<a href="ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP3/iis-fix/">
ftp://ftp.microsoft.com/bussys/winnt/winnt-public/fixes/usa/nt40/hotfixes-postSP3/iis-fix/</a>.


<P><I>Netscape</I>

<P>People have found bugs in Netscape's Communications server on NT as
well. Check out <A HREF="http://superior.berkeley.edu/hypermail/ucb-www/0125.html">this
e-mail </A>to the www-security mailing list.

<P>One should definitely be aware of <A HREF="ftp://info.cert.org/pub/cert_advisories/CA-96.11.interpreters_in_cgi_bin_dir">CERTs
advisory CA-96.11</A> that describes the problem with having a perl interpreter
accessible over the net.

<P>There is some work going on to get a better situation for people who
want to use perl on NT-machines running webs. Check out Softshore's web page
on <A HREF="http://www.softshore.com.au/cgi-bin/PEARL.BAT?">PERL for NT.</A>

<P>Microsoft have some on-line articles on security and web servers. There
is articles on
<UL>
<LI>
<A HREF="http://www.microsoft.com/infoserv/docs/config.htm">Configuring
and Managing Your Internet Information Server</A>

<LI>
How to <A HREF="http://www.microsoft.com/infoserv/docs/secure.htm">securely
set up the Internet Information Server</A>.

<LI>
<A HREF="http://www.microsoft.com/kb/bussys/iis/q142868.htm">IIS: Authentication
&amp; Security Features</A>

<LI>
<A HREF="http://www.microsoft.com/workshop/admin/adm-sec/websec.htm">The
Evolution of Security on the Web</A>

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q146/1/93.htm">Article Q146193
in Knowledge Base, Internet Information Server FAQ</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-fp"></A>2.8.2 Frontpage</H4>
There are an <A HREF="http://204.96.68.153/frontpage.html">article on the
Bug Net Alert </A>that describes some security problems in Frontpage.

<P>There are some texts on Microsoft's web server on Frontpage security
<UL>
<LI>
<A HREF="http://www.microsoft.com/frontpagesupport/content/q152306/default.htm">Minimum
Access Permissions Required by Frontpage? on Internet Information Server</A>

<LI>
<A HREF="http://www.microsoft.com/frontpage/wpp/primer/security.htm">Security
Issues</A>

<LI>
<A HREF="http://www.microsoft.com/frontpage/wpp/kit/unix.htm">Frontpage
UNIX Security &amp; Configuration</A>

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q156/9/81.htm">Article Q156981
describes How to Assign IP Restrictions in Frontpage</A>

<LI>
<A HREF="http://www.microsoft.com/frontpage/wpp/kit/faq.htm">WPP Frequently
Asked Questions</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-ftp"></A>2.8.3 FTP server security</H4>
There is known problems with the FTP server that ships with Windows NT.
There is another FTP server that comes with the Internet Information Server,
IIS, that is supposedly more secure.

<P>As stated elsewhere in this document, logging is not turned on by default.
To turn on logging of the FTP server, there are a number of registry key
parameters that can be changed. They are located under the following key

<P>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\FtpSvc\Parameters

<P>Some of the parameters are LogAnonymous, LogFileAccess, LogNonAnonymous.

<P>See Microsoft's articles on how to turn on
<UL>
<LI>
<A HREF="http://www.microsoft.com/kb/articles/q115/2/85.htm">Better logging
in the FTP server.</A>

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q101/9/22.htm">Accessing
the root directory.</A>

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q101/2/69.htm">Access Rights
for Anonymous Users of FTP Server</A>

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q112/5/10.htm">LogAnonymous
Does Not Always Make an Entry in System Log</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-ie">2.8.4 Internet Explorer</a></H4>
<em>Some</em> of the security issues on MSIE:
<ul>
   <li> IE sending away your password hash. <br><b>Warning! Following the links below using Internet Explorer
        may reveal your user name and password. Use a temporary fake account with a dummy password or
	any other WEB browser. </b>
   <ul>
      <li> <a href="http://www.ee.washington.edu/computing/iebug/">Over NetBIOS</a>
           (http://www.ee.washington.edu/computing/iebug/)
      <li> <a href="http://www.efsl.com/security/ntie/">Over HTTP</a>
           (http://www.efsl.com/security/ntie/)
	   <br>Source code for this one at <a href="http://www.argo.demon.co.uk/info/ntie.tar.gz">
	   http://www.argo.demon.co.uk/info/ntie.tar.gz</a>.
   </ul>
   <li> Bad Java Virtual Machine in some versions of MSIE: 
        <a href="http://web.mit.edu/twm/www/expbug2/">Internet Explorer File Corruption Bug</a>
	(http://web.mit.edu/twm/www/expbug2/)
   <li> Executing applications on browser machine through Powerpoint:
        <a href="http://www.microsoft.com/ie/security/?/ie/security/powerpoint.htm">
	Two Options Now Available for Fixing PowerPoint Browsing Security Issue</a>
	(http://www.microsoft.com/ie/security/?/ie/security/powerpoint.htm)
</ul>

<p>For more information on Internet Explorer see Microsofts web page 
<A HREF="http://www.microsoft.com/security/ieprod.htm">"Microsoft Internet Explorer Security Information"</A>
(http://www.microsoft.com/security/ieprod.htm).

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-roll"></A>2.8.5 Rollback.exe</H4>
On the NT 4.0 CD-ROM there are a utility called rollback.exe that will
corrupt your system if run. It is not intended for end-users, but someone
slipped and the tool is now out on many users systems.

<P>Without any sign of warning, rollback.exe will remove all system registry
entries, which in turn will leave the system in a state where there are
not easy way to recover. One have to grab the emergency repair disk and
do a restore from the latest backup.

<P>For more information see
<UL>
<LI>
<A HREF="http://www.zdnet.com/intweek/daily/960918a.html">Inter@ctive Week's
article on the issue</A>

<LI>
<A HREF="http://www.microsoft.com/kb/articles/q149/2/83.htm">Microsofts
article in the Knowledge Base</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-shutdown"></A>2.8.6 Shutdown.exe</H4>
There are a bug in the utility shutdown.exe that are part of the NT Resource
Kit. That bug disables the screen saver on a remote machine.

<P>It is confirmed to be a problem on 3.51 systems.

<P>For more information see
<UL>
<LI>
<A HREF="http://www.microsoft.com/kb/articles/q142/0/18.htm">BUG: Shutdown.exe
Disables Windows NT ScreenSaver</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-exchange"></A>2.8.7 Exchange</H4>
There is some information both on Microsoft's web and FTP server as well
on some other sites
<UL>
<LI>
Hints on how to <A HREF="http://www.microsoft.com/exchange/techsupp/exchsec.htm">secure
your Exchange server</A>.

<LI>
Help with <A HREF="http://www.microsoft.com/exchange/evalgd/edrfinb.exe">Microsoft
Exchange Disaster Recovery</A>

<LI>
There are at least two <A HREF="ftp://ftp.microsoft.com/bussys/exchange/exchange-public/fixes/Eng/Exchg4.0/">service
packs for Exchange </A>that fixes a number of bugs.

<LI>
There is an<A HREF="http://www.computek.net/public/SGutknec/exchfaq/ExFAQ09.html">
</A><A HREF="http://www.computek.net/public/SGutknec/exchfaq">Exchange
FAQ</A> with lots of Q &amp;A's. Especially, check out chapter 17 on security.
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-sna"></A>2.8.8 Microsoft SNA</H4>
When installing the complete SNA package, you will get at least three more
services, AFTP, NVAlert and NVRunCmd.
<UL>
<LI>
AFTP is like its TCP/IP counterpart FTP a tool to transfer files over the
net. It might be used for anonymous logins as well.

<LI>
NVRunCmd is a service that lets someone running the NetView network monitoring
tool send ordinary commands over the net that will be executed locally
on the Windows NT machine.
</UL>
Make sure that you have disabled these services if you want to run a more
secure setup.

<hr><h4>
<a name="apps-ccmail"> 2.8.9 cc:Mail </a> </h4>

According to a posting to Bugtraq by Carl Byington 
&lt;<a href="mailto:carl@five-ten-sg.com">carl@five-ten-sg.com </a>>, default installation of 
cc:Mail version 8 with an smtp link has some problems:

<ul><listing>
After installing a cc:Mail release 8 postoffice (and link to smtp) on an
NT3.51 machine, I noticed that the nightly reclaim process is scheduled via
the standard NT "at" command which runs %systemroot%\~callmnt.bat.  This
batch file simply runs yet another batch file %systemroot%\~ccmaint.bat.
Why do this?  Because the second batch file is "hidden", but a simple
"attrib" command removes that "protection", and then your master postoffice
password is nicely visible.

But you might ask, what are the NT security permissions on these batch
files?  Simply "everyone full control".  Oh well, at least I don't need to
worry about forgetting that password.
</listing></ul>

<hr><h4>
<A name="ntsec-apps-spoolss"> 2.8.10 NT Spooler Service </A></h4>

According to a posting to NTBugTraq by 
Ond&#248;ej Holas &lt;<a href="mailto:OHolas@EXCH.DIGI-TRADE.CZ">OHolas@EXCH.DIGI-TRADE.CZ</a>>,
the Spooler Service shipping with Windows NT is susceptible to a denial of service attack:

<ul><listing>
After connecting to \\server\PIPE\SPOOLSS you can send probably any
amount of data to that pipe. Final effect is a memory leak in
SPOOLSS.EXE. The worst thing is, by default this connection can be
initiated over null-session (setting RestrictAnonymous to 1 has no
effect). To disable attack over null-session, you must remove line
"SPOOLSS" from
HKLM\System\CCS\Services\LanmanServer\Parameters\NullSessionPipes
(REG_MULTI_SZ), but after that authenticated users can still fill up
server's memory.
</listing></ul>

<hr><h4>
<a name="apps-odbc">2.8.11 ODBC Security </a></h4>

There are several security issues related to ODBC usage

<ul>
	<li> Add hooks 
	<li> Tracing ODBC connections
</ul>

Any call with indirections, such as calls to ODBC data sources, are possible to
intercept by attaching to pre-made hooks.

By tracing ODBC connections, which is a completely legitime thing to do during 
software development, you can get access to sensitive data, such as user name
for the connected database.

For more information, see
<ul>
	<li> Microsofts <a href="http://www.microsoft.com/data/odbc/wpapers/odbcsecurity.htm"> white paper on ODBC security </a> (http://www.microsoft.com/data/odbc/wpapers/odbcsecurity.htm)
	<li> Microsofts <a href="http://www.microsoft.com/data/odbc/wpapers/registry.htm">whitepaper on changing NT registry settings to prevent ODBC tracing</a>
</ul>


<!-- 2.9 RAS -->
<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-ras"></A>2.9 RAS security</H3>
There are a number of things to do to get better security on remote connections
<UL>
<LI>
Putting the RAS servers on one or more own interfaces in the firewall

<LI>
Be sure to turn on auditing for the RAS function

<LI>
Enable authentication

<LI>
Enable session encryption

<LI>
Enable dialback

<LI>
Specify which hours remote users are allowed
</UL>
To turn on auditing for RAS, use the regedit utility to set the key

<P>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\RasMan\Parameters\Logging

<P>to 1, then restart RAS.

<P>Microsoft have a generic RAS FAQ entitled <A HREF="http://www.microsoft.com/syspro/docs/topten7.htm">Windows
NT Remote Access Services - Common Questions and Answers.</A>

<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-log"></A>2.10 Logging and auditing</H3>
By default, <I>all auditing in Windows NT is turned off.</I> You have to
manually turn on auditing on whatever object you want audited. First off,
you should have a policy for
<UL>
   <LI>what to log (user behaviors, changes on files or processes)
   <LI>for how long to keep the logs
   <LI>whether or not you should turn on auditing on all your machines, or if you
   only turn on logging on the servers
</UL>

Then you should configure the auditing. You should also remember that it
is hard to have a good use of auditing (or any use at all), if you don't
have good tools and a good suite of policies on how to handle the logs.

<P>You have to remember that cranking up auditing might give you performance
degradation. The trick is to find the balance between how much to log without
getting problem.

<P><I>Remember that Windows NT saves the logs locally on disk. If someone
can take control over the machine, it is quite likely that the logs might
be manipulated as well.</I> A better solution might be to send away the
logs to one or more protected, centralized log-servers.

<P>For more information see, Microsofts paper called <A HREF="http://www.microsoft.com/win32dev/netwrk/auditing.htm">Auditing,
or the Other Side of Security</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsyslog"></A>2.10.1 Is there a syslog function in NT?</H4>
No, not out of the box. If you want to have centralized logging for both
UNIX and NT machines you can check out Larry Kahn's syslogutils. To get
access to it, you have to send an email to an autoresponder, <A HREF="mailto:access@kahn@drcoffsite.com">access@kahn.drcoffsite.com</A>,
which mail you back information on how to access his FTP server.

<P>Another syslog server is a program called <A HREF="http://www.noware.acc.co.at/SL4NT.htm">SL4NT
by Franz Krainer.</A>
<p>Also, see the section <a href="ntsec.html#logprod">3.4 Logging products</A>.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-log-move"></A>2.10.2 Can I move the logs to another partition?</H4>
Yes. There is a note on this in the Knowledge Base.

<HR WIDTH="100%">
<H4>
<A NAME="ntsec-log-change"></A>2.10.3 Can I grant access to someone to view
or change the logfiles?</H4>
Yes you can, but there is an error on the manual on how to do it. Check
out Knowledge Base article <A HREF="http://www.microsoft.com/kb/articles/q142/6/15.htm">Q142615
</A>to see why the "Manage auditing and security log" privilege does not
work as documented.

<hr><h4>
<a name="log-not-audited"> 2.10.5 Why doesn't all user right enabling actions show up in the log? </a></h4>
Even though auditing of enabled user rights is turned on in the Policy->Auditing dialog in
User Manager (for Domains), there is a bunch of user rights that are <em> not </em> logged.
One example, which can cause a lot of confusion, is the Backup and Restore user rights.
The cause for these to be excluded is that it would generate too much log entries if enabled.
A new log entry would be written for each backed up or restored file. Why is that? Couldn't 
the backup program just take the backup right once and for all and then backup all of the files,
then discard the right?

<p>See 
<a href="http://www.microsoft.com/ntserver/info/secure_NT_con.htm#a23">Securing Windows NT Installation</a>
(http://www.microsoft.com/ntserver/info/secure_NT_con.htm#a23) for a full list of privileges excluded
from auditing and ways of turning auditing on for these.



<HR WIDTH="100%"><H3>
<A NAME="ntsec-crypto"></A>2.11 Crypto</H3>

<H4>
<A NAME="ntsec-crypto-capi"></A>2.11.1 What is CryptoAPI</H4>
CryptoAPI is a set of encryption APIs that allow developers to develop
applications that work securely over non-secure networks, such as the Internet.

<P>CryptoAPI is shipped with NT version 4 and the Internet Explorer 3.0.
Version 2.0 of CryptoAPI comes with SP3 for NT4.

<P>To get more information on the CryptoAPI, see
<UL>
<LI>
<A HREF="http://www.microsoft.com/intdev/security/cryptfaq.htm">The CryptoAPI
Q &amp; A</A>

<LI>
<A HREF="http://www.microsoft.com/intdev/security/capi/cryptapi.htm">Microsoft
CryptoAPI 1.0</A>

<LI>
<A HREF="http://www.microsoft.com/corpinfo/press/1996/sept96/cryptpr.htm">Microsoft
Releases Beta Version of CryptoAPI 2.0</A>
</UL>

<hr><h4>
<a name="ntsec.html#crypto-strongavail"> 2.11.2 Is strong cryptography available outside the U.S.? </a></h4>

Yes, of course. There is Eric Young's various crypto implementations at <a href="ftp://ftp.psy.uq.oz.au/pub/Crypto/">
ftp://ftp.psy.uq.oz.au/pub/Crypto/ </a>. An RC4 implementation called arcfour can be found in the SSH distribution.

<p> As pointed out by Paul Ashton in a posting to the NT Security list, you can even use the same functions 
that Microsoft them self uses:

<ul>
<code><listing>
#include &lt;windows.h>
#define rc4crypt SystemFunction032
WINBASEAPI WINAPI rc4crypt();

/* rc4crypt(ustring *data, ustring *key) */
/* Usage: rc4crypt key data */

main(int ac, char *av[])
{
	struct ustring
	{
		DWORD len;
		DWORD maxlen;
		unsigned char *str;
	} data, key;
	int i;
	
	key.len = key.maxlen = strlen(av[1]);
	key.str = av[1];
	data.len = data.maxlen = strlen(av[2]);
	data.str = malloc(data.len + 1);
	strcpy(data.str, av[2]);
	rc4crypt(&data, &key);
	for (i = 0; i &lt; data.len; i++)
		printf("%02x ", data.str[i]);
	printf("\n");
}

Link with advapi32.
</listing></code></ul>

Looking at the functions exported by advapi32.dll, you will notice that SystemFunction032() is 
accompanied with 32 more functions named like that, SystemFunction001 through SystemFunction033.
Known today is that they include code for the following:
<ul>
   <li> ECB mode DES for calculating LanMan hashes (see <a href="#pw">2.14 Passwords</a>)
   <li> RC4 (as mentioned above)
   <li> MD4
</ul>


<!-- 2.12 -->

<HR WIDTH="100%"><H3>
<A NAME="ntsec-email"></A>2.12 E-mail security</H3>
See also
<UL>
<LI>
<A HREF="ntsec.html#ntsec-file-pgp">3.5.1 Pretty Good Privacy, PGP</A>

<LI>
Windows NT Magazine's article on e-mail security, <A HREF="http://www.winntmag.com/ns-search/articles/May96/EMAIL.HTM?NS-search-set=\32565\s8l.565b92&NS-doc-offset=0&">Secure
Enterprise Email</A>
</UL>

<hr><h3> 
<a name="secpatch"> 2.13 Security related patches </a> </h3>

<p>It's always great fun to read the README.TXT's for the service packs.
They reveal problems that you weren't aware of directly, but can serve as a clue
to other problems you have encountered.

<hr><h4>
<a name="secpatch-4sp3">2.13.1 Security enhancements in SP3 for NT 4 </a></h4>

See <a href="http://www.microsoft.com/ntserver/info/secenhance.htm">
Windows NT 4.0 Service Pack 3 Security Enhancements</a>
(http://www.microsoft.com/ntserver/info/secenhance.htm) and
<ul>
<a href="http://premium.microsoft.com/support/kb/articles/q152/8/41.asp">
$$$: Q152841 - Windows NT 4.0 Service Pack 3 Readme.txt File (40-bit)</a> or

<br><a href="http://premium.microsoft.com/support/kb/articles/q147/7/98.asp">
$$$: Q147798 - Windows NT 4.0 Service Pack 3 Readme.txt File (128-bit)</a>
</ul>
depending on your current browser/proxy location on the globe &lt;sigh&gt;.

<p> Includes things like:
<ul>
	<li>Another obfuscation layer around the SAM database (aka "Strong encryption of password database").
	   The syskey.exe utility gives the opportunity to encrypt the passwords stored in the registry
	   another round, using a 128-bit key that optionally can be stored on a floppy disk to avoid that it
	   is used by the bad guy to decrypt the data. It has to be stored <em>somewhere</em> though, if the
	   system itself is to validate
	   any logons at all. Most probably, it's not stored on any permanent media but rather in memory, presumably
	   only readable by kernel mode programs. But, of course, even there it could be read if you wrote some
	   code for it (as a device driver for example, or see
	   <a href="http://www.sonic.net/~undoc/ntcallgate.html">
	   Run any Ring 0 code from a Win32 application on Windows NT</a>
	   (http://www.sonic.net/~undoc/ntcallgate.html))
	   and had the power to install it. There is a KB article:
	   <a href="http://premium.microsoft.com/support/kb/articles/q143/4/75.asp">
	   Q143475 -Windows NT System Key Permits Strong Encryption of the SAM </a>.
	<li>Password filtering. The library passfilt.dll enables some checking of
            the quality of chosen passwords. It is possible to supply your own
	    version of passfilt.dll. See the following KB articles for more information:
	     <a href="http://www.microsoft.com/kb/articles/q161/9/90.htm">
	     $$$: Q161990 - Enable Strong Password Functionality in Windows NT </a>
	     (http://www.microsoft.com/kb/articles/q161/9/90.htm).
	<li>Update of CryptoAPI from 1.0 to 2.0
	<li>Changes to the default file permissions (ACLs) on the repair and
	    backup directories
	<li>Fixes to some denial of service (DoS) attacks
	<li>Options to restrict anonymous logon and enumerations
	<li>Optional SMB packet signing to prevent forging of packets
	    (<a href="http://support.microsoft.com/support/kb/articles/Q161/3/72.asp">
	    $$$: Q161372 - How to Enable SMB Signing in Windows NT</a>)
	<li>Optional restriction on the usage of older authentication protocols
	    which sends authentication data in the non-encrypted form
</ul>


<hr><h3>
<a name="pw"> 2.14 Passwords </a></h3>

For starters, do read Alan Ramsbottom's &lt;<a href="mailto:acr@als.co.uk">acr@als.co.uk</a>> excellent
<a href="http://www.ntbugtraq.com/samfaq.htm">NT Cryptographic Password Attacks & Defences FAQ</a>
(http://www.ntbugtraq.com/samfaq.htm).

<p>Note that passwords are stored in the registry in two formats, the NT way (MD4) and the old
LANman way (three DES encryptions of magic constant using different parts of the password).
These are <em> password equivalents </em> in the sense that they are the only thing that is
needed for a successfull authentication. <b> This means that you don't have to crack them (using
dictionary or brute force) to use them for authentication. </b>

<p>Also, note that the SAM database is backed up to an ordinary file %SystemRoot%\repair\sam._
whenever a repair disk is created with the rdisk.exe program.

<hr><h4>
<a name="pw-service"> 2.14.1 Where is the password that I configure a service to start with stored? </a></h4>
From a posting by Paul Ashton &lt;<a href="mailto: paul@argo.demon.co.uk">paul@argo.demon.co.uk</a>> on NTBugtraq:
<ul><listing>
   HKLM\SECURITY\Policy\Secrets\_SC_servicename\CurrVal contains the
   encrypted password of the service. The password is not machine or
   account dependent. i.e. a user foo with password bar in domain X
   in NT3.51 has the same encrypted value as user baz in domain Y with
   NT4.0 (with password bar).
</ul></listing>

<p>The <A HREF="http://listserv.ntbugtraq.com/SCRIPTS/WA-NTBT.EXE?A2=ind9708&L=ntbugtraq&P=R627">lsadump</A>
program by Paul Ashton can be used to retrieve the plaintext service password.

<hr><h4>
<a name="pw-notif"> 2.14.2 How do I enforce strong passwords? </a></h4>
See <a href="http://support.microsoft.com/support/kb/articles/Q151/0/82.asp">
$$$: Q151082 - HOWTO: Password Change Filtering & Notification in Windows NT </a>.



<!-- 3.0 -->
<HR WIDTH="100%">
<H2>
<A NAME="tools"></A>3.0 NT based security tools and products</H2>

<H3>
<A NAME="ntcheck"></A>3.1 Tools for checking and tightening NT security</H3>
To secure a system, one good idea is to use automatic tools that checks
the system for misconfigurations, vulnerabilities, break-ins, etc.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcheck-ksa"></A>3.1.1 KSA</H4>
<A HREF="http://www.intrusion.com">Intrusion Detection Inc.</A> have a
product called <A HREF="http://www.intrusion.com/ksant.htm">Kane Security
Analyst</A> that checks your Windows NT system for vulnerabilities.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcheck-omni"></A>3.1.2 OmniGuard</H4>
<A HREF="http://www.axent.com">Axent</A> has a series of tools called <A HREF="http://www.axent.com">OmniGuard</A>
that includes single sign on, intruder detection, access control, etc.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcheck-dump"></A>3.1.3 SomarSoft's DumpACL, DumpEvt and DumpReq</H4>
Somarsoft have a suit of tools for <A HREF="http://www.somarsoft.com">dumping
</A>information from NTs databases and logs.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcheck-crack"></A>3.1.4 Andy Baron's Password Cracker</H4>
<A HREF="http://www.omna.com/yes/AndyBaron/pk.htm">ScanNT</A> is a dictionary
based password cracker that check your NT machine for weak passwords.

<P>A demo version is available from the URL above.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcheck-iss"></A>3.1.5 ISS</H4>
<A HREF="http://www.iss.net">Internet Security Systems</A>, ISS, have a
suite of tools for network security testings that are available on the
NT platform.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-portscan"></A>3.1.6 TCP/IP Portscan</H4>
There is a shareware program called <A HREF="http://www.fbsolutions.com/clbrown/ntfnt.htm">NTPortscan</A>
that scans the net for open TCP ports.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-apps-nat"></A>3.1.7 The NetBIOS Auditing Tool</H4>
Secure Networks Inc. has released a tool called NetBIOS Auditing Tool that
will check file shares, password integrity, extract information, etc, from
a remote host.

<P>The tool is free of charge and released with source code and distributed
under the GNU public license.

<P>Check out Secure Networks' <A HREF="http://www.secnet.com/ntinfo/ntaudit.html">NAT
web page</A> (http://www.secnet.com/ntinfo/ntaudit.html) or download the
<UL>
<LI>
<A HREF="ftp://ftp.secnet.com/pub/tools/nat10/nat10.tar.gz">Distribution
including source code</A> (ftp://ftp.secnet.com/pub/tools/nat10/nat10.tar.gz)

<LI>
<A HREF="ftp://ftp.secnet.com/pub/tools/nat10/nat10bin.zip">WinNT/Win95
binaries </A>(ftp://ftp.secnet.com/pub/tools/nat10/nat10bin.zip)<A HREF="ftp://ftp.secnet.com/pub/tools/nat10/nat10bin.zip">.</A>
</UL>

<HR WIDTH="100%">
<H3>
<A NAME="ntfw"></A>3.2 NT based firewalls</H3>
For details and descriptions on how, what and why on firewalls, check out
Marcus's <A HREF="http://www.it.kth.se/~rom/">firewalls FAQ</A>.

<P>The National Computer Security Association has certified a number of
firewalls for all types of platforms. Check out their <A HREF="http://www.ncsa.com/fpfs/fwindex.html">web page
</A>that lists those firewalls and give detailed information on each product.

<P>For a more complete listing of firewall products, visit Cathy Fulmer's
<A HREF="http://www.greatcircle.com/firewalls/vendors.html">firewalls product
list</A>.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntfw-rapt"></A>3.2.1 Raptor Eagle</H4>
<A HREF="http://www.raptor.com">Raptor</A> has a version of it's Eagle
firewall available for the Windows NT platform.

<P>Click here to get their <A HREF="http://www.raptor.com/prodinfo/ds/eagleNT/eagleNT.html">product
information</A>.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntfw-fw1"></A>3.2.2 Firewall-1</H4>
<A HREF="http://www.checkpoint.com">Checkpoint Software</A> has a version
of it's Firewall-1 firewall available for the Windows NT platform.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntfw-cat"></A>3.2.3 The Catapult Microsoft proxy server</H4>
The Catapult is a proxy program, which is somewhat different from a pure
firewall.

<P>For more information on Catapult, check out 
<ul>
	<li> Microsofts  <a href="http://www.microsoft.com/proxy">proxy server page</a>
	(http://www.microsoft.com/proxy)
	<li> Microsofts own
	<a href="http://www.microsoft.com/proxy/beta/faq.htm">proxy FAQ page</a>
	(http://www.microsoft.com/proxy/beta/faq.htm)
</ul>


<HR WIDTH="100%"><h4>
<A NAME="ntfw-altavista"></A>3.2.4 Digital Altavista Firewall for Windows NT</H4>
Digital Equipment Corp. has a version of it's 
<A HREF="http://altavista.software.digital.com/products/firewall/brief/nfwinnt.htm">Altavista
firewall for Windows NT.</A>

<P>They also have
<UL>
<LI>
<A HREF="http://demos.altavista.software.digital.com/cgi-bin/download.cgi/?product=firewall">on-line
evaluation copy of the software.</A>

<LI>
a <A HREF="http://altavista.software.digital.com/products/firewall/faq/nfintro.htm">FAQ</A>
on Altavista Firewall
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="ntfw-gauntlet"></A>3.2.5 TIS Gauntlet Firewall for Windows NT</H4>
In December 1996 Trusted Information Systems, TIS, released their well
known Gauntlet firewall for Windows NT. It runs on WNT 4.0 Advanced Server.

<P>For more information
<UL>
<LI>
See TIS' <A HREF="http://www.tis.com/docs/products/gauntlet/gauntletNT/index.html">Gauntlet
NT overview</A>

<LI>
Check out <A HREF="http://www.tis.com/docs/corporate/press/96/ntpr.html">TIS'
press release</A>
</UL>

<HR WIDTH="100%">
<H3>
<A NAME="ntcryp"></A>3.3 Secure network sessions</H3>

<HR WIDTH="100%">
<H4>
<A NAME="ntcryp-ssh"></A>3.3.1 Secure Shell, SSH</H4>
SSH is a software package originally developed by a finish student named
Tatu Yl&ouml;nen to secure network communication between different hosts.

<P>There are currently a beta version out for an windows client.

<P>You can find more information on SSH on <A HREF="http://www.datafellows.com/f-secure">Datafellows
web server.</A>There is a <A HREF="http://www.cs.hut.fi/ssh/">SSH homepage</A>
and a <A HREF="http://www.uni-karlsruhe.de/~ig25/ssh-faq">SSH FAQ</A>.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcryp-krb"></A>3.3.2 Kerberos 4 client</H4>
Kerberos gives you secure authentication and an encrypted network session.

<P>To run Kerberos, you have to have at least one Kerberos server available
to hold the kerberos tickets. For more information on Kerberos, consult
the <A HREF="http://www.ov.com/misc/krb-faq.html">Kerberos FAQ</A>.

<P>There is a Kerberos v. 4 client, currently in beta, available for Windows
NT. You can check it out on <A HREF="ftp://ftp.pdc.kth.se/pub/krb/binaries/i386-unknown-winnt4.0">this
ftp server</A>. Unfortunately, there are only UNIX Kerberos server sides
available <A HREF="ftp://ftp.pdc.kth.se/pub/krb/src">here</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntcryp-secid"></A>3.3.3 SecurID</H4>
SecurID is a token based one-time password system that gives you a secure
authentication. There is Windows NT and Windows NT RAS clients available
from the vendor, <A HREF="http://www.securid.com">Security Dynamics</A>

<P>Security Dynamics have a some security resources on-line, such as <A HREF="http://www.securid.com/ID150.586054424103/Resources/index.html">FAQs,white
papers, etc</A>

<P>Be aware that there have been alot of controversy lately since a posting
of a <A HREF="ftp://ftp.secnet.com/pub/papers/securid.ps">white paper</A>
describing some weaknesses of the product.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-skey"></A>3.3.4 S/KEY</H4>
Bellcore's S/Key User Authentication System with One-Time Passwords are
available both as a client program and should be available as a server
program for Windows NT by the time you read this. S/key are available for
a number of UNIX platforms, Windows 3.11, 95, NT 3.51 and 4.0.

<P>Check out
<UL>
<LI>
<A HREF="http://www.bellcore.com/SECURITY/skey.html">Bellcore's WWW page
for S/KEY</A> (http://www.bellcore.com/SECURITY/skey.html)

<LI>
<A HREF="http://www.bellcore.com/SECURITY/skeywp.html">Bellcore's S/KEYwhite
paper</A> (http://www.bellcore.com/SECURITY/skeywp.html)
</UL>

<HR WIDTH="100%">
<H3>
<a name="logprod">3.4 Logging and auditing tools and products</a></H3>

<H4>
<A NAME="logprod-sentry"> 3.4.1 seNTry </A></H4>
The product SeNTry is used for centralized event log viewing and management.
This product is not to be confused with Soft Winters disk encryption tool 
named <cite> SENTRY 2020 </cite>.

<P>Check it out on <A HREF="http://www.pss.ch/SENTRY.htm">http://www.pss.ch/SENTRY.htm</A>

<P>See <a href="ntsec.html#ntsyslog">2.10.1</a> for information on different tools to get the syslog

<hr><h4>
<a name="logprod-eventslog"> 3.4.2 EventSLog </a></h4>
EventSLog from Adiscon, Inc extracts entries from the NT event log and sends them to a syslog server
using the syslog protocol.
<p> See <a href="http://www.adiscon.com/tools/evntslog/default.htm"> http://www.adiscon.com/tools/evntslog/default.htm </a>.

<!-- 3.5 -->

<P>
<HR WIDTH="100%">
<H3>
<A NAME="ntsec-file"></A>3.5 File encryption and electronic mail</H3>

<H4>
<A NAME="ntsec-file-pgp"></A>3.5.1 Pretty Good Privacy, PGP</H4>
There are a number of good PGP resources out on the net. The list below
is just a short selection

<UL>
   <li><A HREF="www.pgp.com">PGP Inc's home page</A> (www.pgp.com)
   
   <li><A HREF="www.pgpi.com">International PGP home page</A> (www.pgp.com)

   <LI> There is a web page that describes how to use
   <A HREF="http://www.cape.com/help/pgp_win.htm">PGP and windows.</A>

   <LI> Another page to visit is the tutorial called
   <A HREF="http://www.seattle-webworks.com/pgp/">PGP and Anonymous mail made simple using Windows</A>.

   <LI> Check out Greg Wolfe's
   <A HREF="http://www.sover.net/~greywolf/pgpguide/">PGP Beginner's Guide for DOS - Windows - Email</A>.
</UL>

A program called PgpEudra to integrate the Eudora mail handling program
with PGP.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="ntsec-file-mimesweep"></A>3.5.2 MIMEsweeper</H4>
There is a product called MIMEsweeper from Integralis that checks e-mail
for viruses. Integralis have both a <A HREF="http://www.mimesweeper.integralis.com/Marketing/Public/msw_spd.htm">product
description page </A>and a <A HREF="http://www.mimesweeper.integralis.com/Technical/Public/msw_FAQs.htm">FAQ
on MIMEsweeper</A> available on the net.


<HR WIDTH="100%">
<H4>
<A NAME="ntsec-file-shade"></A>3.5.3 SENTRY 2020 (former Shade) disk/file encryption</H4>
Soft Winter Corporation, located in Israel, does have a product for disk
encryption on Windows NT.

<P>Check out the product on <A HREF="http://www.softwinter.com/"> http://www.softwinter.com/ </a>


<HR WIDTH="100%">
<H3>
<A NAME="otherprod"></A>3.6 Other types of security products</H3>

<HR WIDTH="100%">
<H4>
<A NAME="otherprod-ca"></A>3.6.1 CA-UniCenter </H4>

<HR WIDTH="100%">
<H4>
<A NAME="otherprod-radius"></A>3.6.2 Steel-belt RADIUS server for Windows
NT</H4>
Funk Software have developed a Radius server for Windows NT and NetWare.

<P>For more information see the <A HREF="http://www.funk.com/sbrwinnt.htm">Steel-Belted
Radius for Windows NT Data Sheet</A>
<H2>

<HR WIDTH="100%"><A NAME="online"></A>4.0 Where can I find on-line information
on NT security</H2>

<H3>
<A NAME="online-ml"></A>4.1 Mailing lists</H3>

<H4>
<A NAME="online-ml-ntsec"></A>4.1.1 NT Security Mailing list</H4>
There is a NT security mailing list maintained by the good folks at ISS.
You subscribe to it by sending a mail to <A HREF="mailto:majordomo@iss.net">majordomo@iss.net</A>
with the body containing the string "subscribe ntsecurity your email".

<P>The mailing list have some traffic and on-going discussion, and some
people might prefer to subscribe to the digest version instead to reduce
their incoming mail. The digest is available by sending mail to the same
address but with the text "subscribe ntsecurity-digest your email".

<P>The mailing list is archived with a web interface at <A HREF="http://www.iss.net/lists">http://www.iss.net/lists.</A>
It is also available for anonymous FTP from <A HREF="http://www.it.kth.se/~rom/ntsecurity-digest.archive">ftp://ftp.iss.net/pub/lists/ntsecurity-digest.archive</A>.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="online-nl-ntbugtraq"></A>4.1.2 NTBugTraq</H4>
The NTBugTraq is the Windows NT counterpart of the BugTraq mailing list
that is mainly for UNIX related bugs with impact on security. It was started
by Russ Cooper 
&lt;<a href="mailto:Russ.Cooper@rc.on.ca">Russ.Cooper@rc.on.ca</a>&gt;
in the end of January, 1997. It is a moderated list.

<P>Subscribe by sending a mail to listserv@listserv.ntbugtraq.com.
For help with this, have a look at <a href="http://www.ntbugtraq.com/ntbugfaq.htm">
http://www.ntbugtraq.com/ntbugfaq.htm</a>

<p>The NTBugtraq archives are at 
<a href="http://listserv.ntbugtraq.com/archives/ntbugtraq.html">
http://listserv.ntbugtraq.com/archives/ntbugtraq.html</a>


<P>
<HR WIDTH="100%">
<H3>
<A NAME="online-web"></A>4.2 Web pages and white papers</H3>

<H4>
<A NAME="online-web-ms"></A>4.2.1 Microsoft</H4>
Microsoft has some information on-line. It might be contained in the Knowledge
Base archive, it might be in product white papers. Lately, Microsoft has been 
moving a lot of information inside some sort of protected area, called <cite>
MSDN Online </cite>. To register as a member, which for now is free, you unfortunately
have to enable JavaScript and/or Java in your WEB browser. Once registered you
can disable Java, but a lot of things are depending on JavaScript, such as the
<cite> find </cite> button at 
<a href="http://support.microsoft.com/support/">$$$: http://support.microsoft.com/support/</a>.
You should be able to follow the links in this FAQ without enabling 
either of the two, but for the links denoted with <cite> $$$ </cite>, such as
the one above, you have to be registered as a MSDN Online member.

A selection of interesting
information from www.microsoft.com
<UL>

<li>
<a href="http://www.microsoft.com/security"> Security Advisor Program </a>


<li>
<a href="http://support.microsoft.com/support/">$$$: Search Technical Support </a>.
Here, you can punch in a Knowledge Base article number and retrieve the article.


<LI>
<A HREF="http://www.microsoft.com/WIN32DEV/NETWRK/SECGUTS.HTM">The guts
of security</A>


<LI>
<A HREF="http://www.microsoft.com/WIN32DEV/NETWRK/SECCPP.HTM">Windows NT
Security in Theory and Practice</A>

<LI>
<A HREF="http://www.microsoft.com/WIN32DEV/NETWRK/BITSPCS.HTM">Security
Bits and Pieces</A>

<LI>
<A HREF="http://www.microsoft.com/win32dev/netwrk/auditing.htm">Auditing,
or the Other Side of Security</A>
</UL>

<HR WIDTH="100%">
<H4>
<A NAME="online-web-ntr"></A>4.2.2 NT Research</H4>
There is a good white paper available from <A HREF="http://ntresearch.com">NT
Research</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="online-web-som"></A>4.2.4 SomarSoft</H4>
Frank Ramos at <A HREF="http://www.somarsoft.com/security.htm">SomarSoft</A>
have both some information and some tools available on-line. There are
demo versions of the tools for downloading.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="online-web-omn"></A>4.2.5 OMNA</H4>
Andy Baron has some nice information on-line at his site. Some of the information
is related to <A HREF="http://www.omna.com">Microsoft's web server IIS</A>

<P>
<HR WIDTH="100%">
<H4>
<A NAME="online-web-iss"></A>4.2.6 ISS Vulnerability database</H4>
<A HREF="http://www.iss.net">Internet Security Systems</A>, ISS (http://www.iss.net),
have a <A HREF="http://www.iss.net/vd/vuln/nt">NT specific area</A> (http://www.iss.net/vd/vuln/nt)
in their vulnerability database.

<P>
<HR WIDTH="100%">
<H4>
<A NAME="online-web-ntshop"></A>4.2.8 NT Shop's NT Security pages</H4>
At NT Shop they have a collection of NT related security information such
as exploits and white papers on security issues and concerns.

<P>Visit the <A HREF="http://www.ntshop.net/security">NT Security web pages</A>
(http://www.ntshop.com/security)
<H2>

<HR WIDTH="100%"></H2>

<H3>
<A NAME="books"></A>4.3 What books on NT security are available?</H3>
Microsoft Press have a book entitled <A HREF="http://www.microsoft.com/MSPRESS/BOOKS/DES/5-814-9a.hTM">"Microsoft
NT 3.5 Guidelines for Security, Audit, and Control."</A> ISBN 1-55615-814-9.

<P>Trusted Systems have a book entitled <A HREF="http://www.trustedsystems.com/NTBook.html">"Windows
NT Security" </A>(http://www.trustedsystems.com/NTBook.html)

<P>Tom Sheldon (<A HREF="mailto: tsheldon@msn.com">tsheldon@msn.com</A>)
has written a book entitled "The Windows NT Security Handbook". It is scheduled
for publication in October, 1996.

<P>Charlie Rutstein (<A HREF="mailto: Charlie_Rutstein@notes.pw.com">Charlie_Rutstein@notes.pw.com</A>)
has an upcoming book on NT Security. Click <A HREF="http://ourworld.compuserve.com/homepages/cbr/toc.html">here</A>
(http://ourworld.compuserve.com/homepages/cbr/toc.html) to see a table
of content of the book.

<P>Mark Joseph Edwards, Peter Cardin and Andy Baron has written a book entitled 
<a href="http://dukepress.com/dukepress/Uniquebook2.dbm?NextBook=115&DATE=08-Oct-97">
"Windows NT Internet Security"</a>.
"Windows NT Security Handbook - Everything you need to know to protect your network". Unfortunately, in our opinion, it does not live up to its claim to provide all knowledge you need. It have shortcomings in several areas, such as details in file system security.

<p>Another problem is the rapid development in the software area. Microsoft have 
released a number of new products and technologies and renamed some major and
several minor subsystems.
<ul>
   <li>"Windows NT Security Handbook - Everything you need to know to protect your network" has ISBN 0-07-882240-8.

   <li>The book "Inside Windows NT", a classic, give an in-depth description on the Windows NT operating system.
</ul>

<!-- <BR>&nbsp; -->

<hr><H2>
<A NAME="exploits">5.0 Widely known exploits, security holes and their counter measures</a></H2>
<ul>
   <li> Bill Stout's <a href="http://www.ntbugtraq.com/ntexploits.htm">Known NT Exploits</a>
   (http://www.ntbugtraq.com/ntexploits.htm) 
   <li> <a href="http://www.iss.net/vd/nt_vulnerabilities.html">ISS Security Library</a>
   (http://www.iss.net/vd/nt_vulnerabilities.html)
</ul>


<hr>
<P>Copyright &copy; 1996, 1997 Robert Malmgren. All rights reserved.
</BODY>
</HTML>
<!-- -->
</plaintext></a><br clear=all>
<p><img src="http://www4.ncsu.edu/graphics/nothing.gif"></p>
</script>
</table>
<p align=center>
<HR SIZE=1 WIDTH=50%>
<table width=100%>
<tr><td align=center>
<img src="http://www4.ncsu.edu/graphics/disclaimer.gif" 
alt = "The material on this site is not endorsed, sponsored, provided, or on behalf of North Carolina State University">
</td></tr>
</table>
<!-- uni00ws02.unity.ncsu.edu -->
</body>
</html>